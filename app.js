function budgetService(e,t,n){var r=[],o=[],u=function(){return 0!=r.length?e.when(r):t.getAllBudgets().then(function(e){return r=e})},i=function(e){t.saveBudget(e).then(function(e){r.push(e)},function(e){console.log(e)})},c=function(e){t.getBudget(e).then(function(e){return e},function(e){return console.log(e),null})},s=function(){return 0!=o.length?e.when(o):t.getAllBudgetItems().then(function(e){return o=e})},l=function(e){t.saveBudgetItem(e).then(function(e){o.push(e)},function(e){console.log(e)})},a=function(e){return o.reduce(function(t,n){return n.budgetId==e.id?t+n.amount:t},0)},g=function(){var e=0;return angular.forEach(r,function(t){if("Fixed"==t.name||"Flex"==t.name){var n=a(t);e+=n}}),e},d=function(){return o.reduce(function(e,t){return e+t.amount},0)},f=function(e){return e.percentAllotment/100*n.total("net")},m=function(e){return a(e)/n.total("net")*100},h=function(e){return f(e)-a(e)},v=function(){return r.reduce(function(e,t){return e+t.percentAllotment},0)},p=function(){var e=n.total("gross"),t=n.total("net");return(e-t)/e},y=function(){return r.reduce(function(e,t){return e+m(t)},p())};this.getAllBudgets=u,this.saveBudget=i,this.getBudget=c,this.getAllBudgetItems=s,this.saveBudgetItem=l,this.total=a,this.totalCore=g,this.totalAll=d,this.budgetCap=f,this.budgetUtilization=m,this.budgetBalance=h,this.guidelineTotal=v,this.taxUtilization=p,this.overviewUtilizationTotal=y}function deploydService(e,t,n){var r=function(){var r=t.defer();return e.get(n+"/budgets").success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise},o=function(r){var o=t.defer();return e.post(n+"/budgets",{name:r.name,percentAllotment:r.percent}).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},u=function(r){var o=t.defer();return e.get(n+"/budgets",{id:r}).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},i=function(){var r=t.defer();return e.get(n+"/budget-items").success(function(e){r.resolve(e)}).error(function(e){console.log(e)}),r.promise},c=function(r){var o=t.defer();return e.post(n+"/budget-items",{name:r.name,amount:r.amount,budgetId:r.budget.id}).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},s=function(){var r=t.defer();return e.get(n+"/income-sources").success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise},l=function(r){var o=t.defer();return e.post(n+"/income-sources",{job:r.job,incomeTypeId:r.incomeType.id,payrate:r.payrate,hours:r.hours,taxPercent:r.taxPercent}).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},a=function(){var r=t.defer();return e.get(n+"/income-types").success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise},g=function(r){var o=t.defer();return e.get(n+"/income-types?id="+r).success(function(e){o.resolve(type)}).error(function(e){console.log(e)}),o.promise};this.getAllBudgets=r,this.saveBudget=o,this.getAllBudgetItems=i,this.saveBudgetItem=c,this.getBudget=u,this.getAllIncomes=s,this.saveIncome=l,this.getAllIncomeTypes=a,this.getIncomeType=g}function normalizeIncomes(e){angular.isArray(e)||(e=[e]);var t=[];return angular.forEach(e,function(e){var n={};n.job=e.job,n.payrate=e.payrate,n.hours=e.hours,n.gross=e.payrate*e.hours*4,n.tax=e.taxPercent,n.net=n.gross*(1-e.taxPercent/100),n.biweekly=n.net/2,t.push(n)}),t}function getHours(e){switch(e){case"Weekly":case"Bi-Weekly":case"Yearly":return 40;case"Semi-Monthly":case"Monthly":return 520/12}}function getAdjustedPayrate(e,t){switch(t){case"Weekly":return e;case"Bi-Weekly":return e/80;case"Semi-Monthly":return e/(520/6);case"Monthly":return e/(520/3);case"Yearly":return e/2080}}function incomeService(e,t){var n=[],r=[],o=function(){return 0!=n.length?e.when(n):t.getAllIncomes().then(function(e){return n=normalizeIncomes(e)})},u=function(e){e.payrate=getAdjustedPayrate(e.payrate,e.incomeType.name),e.hours=e.hours?e.hours:getHours(e.incomeType.name),t.saveIncome(e).then(function(e){n.push(self.normalizeIncomes(e)[0])},function(e){console.log(e)})},i=function(){return 0!=r?e.when(types):t.getAllIncomeTypes().then(function(e){return r=e})},c=function(e){return t.getType(e).then(function(e){return e})},s=function(e){return n.length>0&&isFinite(n[0][e])?n.reduce(function(t,n){return t+n[e]},0):void 0},l=function(e){return 13*e.gross},a=function(e){return 13*e.net},g=function(){return n.reduce(function(e,t){return e+l(t)},0)},d=function(){return n.reduce(function(e,t){return e+a(t)},0)};this.getAllIncomes=o,this.saveIncome=u,this.getAllIncomeTypes=i,this.getIncomeType=c,this.yearlyGross=l,this.totalYearlyGross=g,this.yearlyNet=a,this.totalYearlyNet=d,this.total=s}function projectedBalanceService(e,t){var n=function(){return e.total("net")-t.totalAll()},r=function(e){return angular.isNumber(e)?t.totalCore()*e:t.totalCore()};this.getBalance=n,this.getCoreExpenses=r}angular.module("budgettingIsFun",["angular.filter"]).controller("BaseController",["$scope",function(e){e.welcomeMessage="Welcome Savy Budgetter"}]),angular.module("customFilters",[]).filter("unique",function(){return function(e,t){if(angular.isArray(e)&&angular.isString(t)){for(var n=[],r={},o=0;o<e.length;o++){var u=e[o][t];angular.isUndefined(r[u])&&(r[u]=!0,n.push(e[o]))}return console.log(n),n}return e}}),angular.module("budgettingIsFun").controller("BudgetController",["budgetService","incomeService",function(e,t){var n=this;n.budgets=[],n.budgetItems=[],e.getAllBudgets().then(function(t){n.budgets=t,e.getAllBudgetItems().then(function(e){n.budgetItems=e},function(e){console.log(e)})},function(e){console.log(e)}),n.newBudget={},n.saveBudget=function(t){e.saveBudget(t),n.newBudget={}},n.newBudgetItem={},n.saveBudgetItem=function(t){e.saveBudgetItem(t),n.newBudgetItem={}},n.budgetCap=e.budgetCap,n.budgetUtilization=e.budgetUtilization,n.budgetBalance=e.budgetBalance,n.guidelineTotal=e.guidelineTotal,n.taxUtilization=e.taxUtilization,n.overviewUtilizationTotal=e.overviewUtilizationTotal,n.total=e.total}]),angular.module("budgettingIsFun").service("budgetService",["$q","deploydService","incomeService",budgetService]),angular.module("budgettingIsFun").constant("deployd","http://localhost:2403").service("deploydService",["$http","$q","deployd",deploydService]),angular.module("budgettingIsFun").controller("IncomeController",["incomeService",function(e){var t=this;t.incomes=[],t.incomeTypes=[],e.getAllIncomes().then(function(e){t.incomes=e},function(e){console.log(e)}),e.getAllIncomeTypes().then(function(e){t.incomeTypes=e},function(e){console.log(e)}),t.newIncome={},t.saveIncome=function(n){e.saveIncome(n),t.newIncome={}},t.totalYearlyGross=e.totalYearlyGross,t.totalYearlyNet=e.totalYearlyNet,t.total=e.total}]),angular.module("budgettingIsFun").service("incomeService",["$q","deploydService",incomeService]),angular.module("budgettingIsFun").controller("ProjectedBalanceController",["projectedBalanceService",function(e){var t=this;t.getBalance=e.getBalance,t.coreExpenses=e.getCoreExpenses}]),angular.module("budgettingIsFun").service("projectedBalanceService",["incomeService","budgetService",projectedBalanceService]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvYnVkZ2V0L2J1ZGdldFNlcnZpY2UuanMiLCJjb21wb25lbnRzL2RlcGxveWQvZGVwbG95ZFNlcnZpY2UuanMiLCJjb21wb25lbnRzL2luY29tZS9pbmNvbWVTZXJ2aWNlLmpzIiwiY29tcG9uZW50cy9wcm9qZWN0ZWRCYWxhbmNlL3Byb2plY3RlZEJhbGFuY2VTZXJ2aWNlLmpzIiwiYXBwLm1vZHVsZS5qcyIsImZpbHRlcnMvY3VzdG9tRmlsdGVycy5qcyIsImNvbXBvbmVudHMvYnVkZ2V0L2J1ZGdldENvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2luY29tZS9pbmNvbWVDb250cm9sbGVyLmpzIiwiY29tcG9uZW50cy9wcm9qZWN0ZWRCYWxhbmNlL3Byb2plY3RlZEJhbGFuY2VDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImJ1ZGdldFNlcnZpY2UiLCIkcSIsImRlcGxveWRTZXJ2aWNlIiwiaW5jb21lU2VydmljZSIsImJ1ZGdldHMiLCJidWRnZXRJdGVtcyIsImdldEFsbEJ1ZGdldHMiLCJsZW5ndGgiLCJ3aGVuIiwidGhlbiIsImFsbEJ1ZGdldHMiLCJzYXZlQnVkZ2V0IiwibmV3QnVkZ2V0IiwicHVzaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJnZXRCdWRnZXQiLCJidWRnZXRJZCIsImJ1ZGdldCIsImdldEFsbEJ1ZGdldEl0ZW1zIiwiYWxsQnVkZ2V0SXRlbXMiLCJzYXZlQnVkZ2V0SXRlbSIsIm5ld0J1ZGdldEl0ZW0iLCJ0b3RhbCIsInJlZHVjZSIsInByZXYiLCJjdXJyIiwiaWQiLCJhbW91bnQiLCJ0b3RhbENvcmUiLCJhbmd1bGFyIiwiZm9yRWFjaCIsIm5hbWUiLCJ4IiwidG90YWxBbGwiLCJidWRnZXRDYXAiLCJwZXJjZW50QWxsb3RtZW50IiwiYnVkZ2V0VXRpbGl6YXRpb24iLCJidWRnZXRCYWxhbmNlIiwiZ3VpZGVsaW5lVG90YWwiLCJ0YXhVdGlsaXphdGlvbiIsImdyb3NzSW5jb21lIiwibmV0SW5jb21lIiwib3ZlcnZpZXdVdGlsaXphdGlvblRvdGFsIiwidGhpcyIsIiRodHRwIiwiZGVwbG95ZCIsImRlZmVycmVkIiwiZGVmZXIiLCJnZXQiLCJzdWNjZXNzIiwicmVzb2x2ZSIsImVycm9yIiwicmVqZWN0IiwicHJvbWlzZSIsInBvc3QiLCJwZXJjZW50IiwiaXRlbXMiLCJpbmNvbWVzIiwic2F2ZUluY29tZSIsIm5ld0luY29tZSIsImpvYiIsImluY29tZVR5cGVJZCIsImluY29tZVR5cGUiLCJwYXlyYXRlIiwiaG91cnMiLCJ0YXhQZXJjZW50IiwiaW5jb21lIiwiaW5jb21lVHlwZXMiLCJ0eXBlIiwiZ2V0QWxsSW5jb21lcyIsImdldEFsbEluY29tZVR5cGVzIiwiZ2V0SW5jb21lVHlwZSIsIm5vcm1hbGl6ZUluY29tZXMiLCJpc0FycmF5Iiwibm9ybWFsaXplZEluY29tZXMiLCJub3JtSW5jb21lIiwiZ3Jvc3MiLCJ0YXgiLCJuZXQiLCJiaXdlZWtseSIsImdldEhvdXJzIiwiZ2V0QWRqdXN0ZWRQYXlyYXRlIiwiYWxsSW5jb21lcyIsInNlbGYiLCJ0eXBlcyIsImFsbEluY29tZVR5cGVzIiwiZ2V0VHlwZSIsInByb3BlcnR5IiwiaXNGaW5pdGUiLCJ5ZWFybHlHcm9zcyIsInllYXJseU5ldCIsInRvdGFsWWVhcmx5R3Jvc3MiLCJ0b3RhbFllYXJseU5ldCIsInByb2plY3RlZEJhbGFuY2VTZXJ2aWNlIiwiZ2V0QmFsYW5jZSIsImNvcmVFeHBlbnNlcyIsIm11bHRpcGxlIiwiaXNOdW1iZXIiLCJnZXRDb3JlRXhwZW5zZXMiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwid2VsY29tZU1lc3NhZ2UiLCJmaWx0ZXIiLCJkYXRhIiwicHJvcGVydHlOYW1lIiwiaXNTdHJpbmciLCJyZXN1bHRzIiwia2V5cyIsImkiLCJ2YWwiLCJpc1VuZGVmaW5lZCIsInNlcnZpY2UiLCJjb25zdGFudCJdLCJtYXBwaW5ncyI6IkFBQUEsUUFBQUEsZUFBQUMsRUFBQUMsRUFBQUMsR0FDQSxHQUFBQyxNQUNBQyxLQUlBQyxFQUFBLFdBQ0EsTUFBQSxJQUFBRixFQUFBRyxPQUNBTixFQUFBTyxLQUFBSixHQUVBRixFQUFBSSxnQkFDQUcsS0FBQSxTQUFBQyxHQUVBLE1BREFOLEdBQUFNLEtBS0FDLEVBQUEsU0FBQUMsR0FDQVYsRUFBQVMsV0FBQUMsR0FDQUgsS0FBQSxTQUFBRyxHQUNBUixFQUFBUyxLQUFBRCxJQUNBLFNBQUFFLEdBQ0FDLFFBQUFDLElBQUFGLE1BSUFHLEVBQUEsU0FBQUMsR0FDQWhCLEVBQUFlLFVBQUFDLEdBQ0FULEtBQUEsU0FBQVUsR0FDQSxNQUFBQSxJQUNBLFNBQUFMLEdBRUEsTUFEQUMsU0FBQUMsSUFBQUYsR0FDQSxRQUtBTSxFQUFBLFdBQ0EsTUFBQSxJQUFBZixFQUFBRSxPQUNBTixFQUFBTyxLQUFBSCxHQUVBSCxFQUFBa0Isb0JBQ0FYLEtBQUEsU0FBQVksR0FFQSxNQURBaEIsR0FBQWdCLEtBS0FDLEVBQUEsU0FBQUMsR0FDQXJCLEVBQUFvQixlQUFBQyxHQUNBZCxLQUFBLFNBQUFjLEdBQ0FsQixFQUFBUSxLQUFBVSxJQUNBLFNBQUFULEdBQ0FDLFFBQUFDLElBQUFGLE1BTUFVLEVBQUEsU0FBQUwsR0FDQSxNQUFBZCxHQUFBb0IsT0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFBLEdBQUFULFVBQUFDLEVBQUFTLEdBQ0FGLEVBQUFDLEVBQUFFLE9BQ0FILEdBQ0EsSUFHQUksRUFBQSxXQUNBLEdBQUFBLEdBQUEsQ0FTQSxPQVBBQyxTQUFBQyxRQUFBNUIsRUFBQSxTQUFBZSxHQUNBLEdBQUEsU0FBQUEsRUFBQWMsTUFBQSxRQUFBZCxFQUFBYyxLQUFBLENBQ0EsR0FBQUMsR0FBQVYsRUFBQUwsRUFDQVcsSUFBQUksS0FJQUosR0FHQUssRUFBQSxXQUNBLE1BQUE5QixHQUFBb0IsT0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFELEdBQUFDLEVBQUFFLFFBQ0EsSUFHQU8sRUFBQSxTQUFBakIsR0FDQSxNQUFBQSxHQUFBa0IsaUJBQUEsSUFBQWxDLEVBQUFxQixNQUFBLFFBR0FjLEVBQUEsU0FBQW5CLEdBQ0EsTUFBQUssR0FBQUwsR0FBQWhCLEVBQUFxQixNQUFBLE9BQUEsS0FHQWUsRUFBQSxTQUFBcEIsR0FDQSxNQUFBaUIsR0FBQWpCLEdBQUFLLEVBQUFMLElBR0FxQixFQUFBLFdBQ0EsTUFBQXBDLEdBQUFxQixPQUFBLFNBQUFDLEVBQUFDLEdBQ0EsTUFBQUQsR0FBQUMsRUFBQVUsa0JBQ0EsSUFHQUksRUFBQSxXQUNBLEdBQUFDLEdBQUF2QyxFQUFBcUIsTUFBQSxTQUNBbUIsRUFBQXhDLEVBQUFxQixNQUFBLE1BRUEsUUFBQWtCLEVBQUFDLEdBQUFELEdBR0FFLEVBQUEsV0FDQSxNQUFBeEMsR0FBQXFCLE9BQUEsU0FBQUMsRUFBQUMsR0FDQSxNQUFBRCxHQUFBWSxFQUFBWCxJQUNBYyxLQUlBSSxNQUFBdkMsY0FBQUEsRUFDQXVDLEtBQUFsQyxXQUFBQSxFQUNBa0MsS0FBQTVCLFVBQUFBLEVBQ0E0QixLQUFBekIsa0JBQUFBLEVBQ0F5QixLQUFBdkIsZUFBQUEsRUFDQXVCLEtBQUFyQixNQUFBQSxFQUNBcUIsS0FBQWYsVUFBQUEsRUFDQWUsS0FBQVYsU0FBQUEsRUFFQVUsS0FBQVQsVUFBQUEsRUFDQVMsS0FBQVAsa0JBQUFBLEVBQ0FPLEtBQUFOLGNBQUFBLEVBQ0FNLEtBQUFMLGVBQUFBLEVBQ0FLLEtBQUFKLGVBQUFBLEVBQ0FJLEtBQUFELHlCQUFBQSxFQ3BJQSxRQUFBMUMsZ0JBQUE0QyxFQUFBN0MsRUFBQThDLEdBRUEsR0FBQTNDLEdBQUEsV0FDQSxHQUFBNEMsR0FBQS9DLEVBQUFnRCxPQVNBLE9BUEFILEdBQUFJLElBQUFILEVBQUEsWUFDQUksUUFBQSxTQUFBL0MsR0FDQTRDLEVBQUFJLFFBQUFoRCxLQUNBaUQsTUFBQSxTQUFBdkMsR0FDQWtDLEVBQUFNLE9BQUF4QyxLQUdBa0MsRUFBQU8sU0FHQTVDLEVBQUEsU0FBQUMsR0FDQSxHQUFBb0MsR0FBQS9DLEVBQUFnRCxPQVdBLE9BVEFILEdBQUFVLEtBQUFULEVBQUEsWUFDQWQsS0FBQXJCLEVBQUFxQixLQUNBSSxpQkFBQXpCLEVBQUE2QyxVQUNBTixRQUFBLFNBQUFoQyxHQUNBNkIsRUFBQUksUUFBQWpDLEtBQ0FrQyxNQUFBLFNBQUF2QyxHQUNBa0MsRUFBQU0sT0FBQXhDLEtBR0FrQyxFQUFBTyxTQUdBdEMsRUFBQSxTQUFBQyxHQUNBLEdBQUE4QixHQUFBL0MsRUFBQWdELE9BVUEsT0FSQUgsR0FBQUksSUFBQUgsRUFBQSxZQUNBbkIsR0FBQVYsSUFDQWlDLFFBQUEsU0FBQWhDLEdBQ0E2QixFQUFBSSxRQUFBakMsS0FDQWtDLE1BQUEsU0FBQXZDLEdBQ0FrQyxFQUFBTSxPQUFBeEMsS0FHQWtDLEVBQUFPLFNBR0FsRCxFQUFBLFdBQ0EsR0FBQTJDLEdBQUEvQyxFQUFBZ0QsT0FTQSxPQVBBSCxHQUFBSSxJQUFBSCxFQUFBLGlCQUNBSSxRQUFBLFNBQUFPLEdBQ0FWLEVBQUFJLFFBQUFNLEtBQ0FMLE1BQUEsU0FBQXZDLEdBQ0FDLFFBQUFDLElBQUFGLEtBR0FrQyxFQUFBTyxTQUdBakMsRUFBQSxTQUFBQyxHQUNBLEdBQUF5QixHQUFBL0MsRUFBQWdELE9BWUEsT0FWQUgsR0FBQVUsS0FBQVQsRUFBQSxpQkFDQWQsS0FBQVYsRUFBQVUsS0FDQUosT0FBQU4sRUFBQU0sT0FDQVgsU0FBQUssRUFBQUosT0FBQVMsS0FDQXVCLFFBQUEsU0FBQTVCLEdBQ0F5QixFQUFBSSxRQUFBN0IsS0FDQThCLE1BQUEsU0FBQXZDLEdBQ0FrQyxFQUFBTSxPQUFBeEMsS0FHQWtDLEVBQUFPLFNBSUFJLEVBQUEsV0FDQSxHQUFBWCxHQUFBL0MsRUFBQWdELE9BU0EsT0FQQUgsR0FBQUksSUFBQUgsRUFBQSxtQkFDQUksUUFBQSxTQUFBUSxHQUNBWCxFQUFBSSxRQUFBTyxLQUNBTixNQUFBLFNBQUF2QyxHQUNBa0MsRUFBQU0sT0FBQXhDLEtBR0FrQyxFQUFBTyxTQUdBSyxFQUFBLFNBQUFDLEdBQ0EsR0FBQWIsR0FBQS9DLEVBQUFnRCxPQWNBLE9BWkFILEdBQUFVLEtBQUFULEVBQUEsbUJBQ0FlLElBQUFELEVBQUFDLElBQ0FDLGFBQUFGLEVBQUFHLFdBQUFwQyxHQUNBcUMsUUFBQUosRUFBQUksUUFDQUMsTUFBQUwsRUFBQUssTUFDQUMsV0FBQU4sRUFBQU0sYUFDQWhCLFFBQUEsU0FBQWlCLEdBQ0FwQixFQUFBSSxRQUFBZ0IsS0FDQWYsTUFBQSxTQUFBdkMsR0FDQWtDLEVBQUFNLE9BQUF4QyxLQUdBa0MsRUFBQU8sU0FJQWMsRUFBQSxXQUNBLEdBQUFyQixHQUFBL0MsRUFBQWdELE9BU0EsT0FQQUgsR0FBQUksSUFBQUgsRUFBQSxpQkFDQUksUUFBQSxTQUFBa0IsR0FDQXJCLEVBQUFJLFFBQUFpQixLQUNBaEIsTUFBQSxTQUFBdkMsR0FDQWtDLEVBQUFNLE9BQUF4QyxLQUdBa0MsRUFBQU8sU0FHQVMsRUFBQSxTQUFBcEMsR0FDQSxHQUFBb0IsR0FBQS9DLEVBQUFnRCxPQVNBLE9BUEFILEdBQUFJLElBQUFILEVBQUEsb0JBQUFuQixHQUNBdUIsUUFBQSxTQUFBYSxHQUNBaEIsRUFBQUksUUFBQWtCLFFBQ0FqQixNQUFBLFNBQUF2QyxHQUNBQyxRQUFBQyxJQUFBRixLQUdBa0MsRUFBQU8sUUFHQVYsTUFBQXZDLGNBQUFGLEVBQ0F5QyxLQUFBbEMsV0FBQUEsRUFDQWtDLEtBQUF6QixrQkFBQWYsRUFDQXdDLEtBQUF2QixlQUFBQSxFQUNBdUIsS0FBQTVCLFVBQUFBLEVBRUE0QixLQUFBMEIsY0FBQVosRUFDQWQsS0FBQWUsV0FBQUEsRUFFQWYsS0FBQTJCLGtCQUFBSCxFQUNBeEIsS0FBQTRCLGNBQUFULEVDN0lBLFFBQUFVLGtCQUFBZixHQUNBNUIsUUFBQTRDLFFBQUFoQixLQUNBQSxHQUFBQSxHQUVBLElBQUFpQixLQWdCQSxPQWRBN0MsU0FBQUMsUUFBQTJCLEVBQUEsU0FBQVMsR0FDQSxHQUFBUyxLQUVBQSxHQUFBZixJQUFBTSxFQUFBTixJQUNBZSxFQUFBWixRQUFBRyxFQUFBSCxRQUNBWSxFQUFBWCxNQUFBRSxFQUFBRixNQUNBVyxFQUFBQyxNQUFBVixFQUFBSCxRQUFBRyxFQUFBRixNQUFBLEVBQ0FXLEVBQUFFLElBQUFYLEVBQUFELFdBQ0FVLEVBQUFHLElBQUFILEVBQUFDLE9BQUEsRUFBQVYsRUFBQUQsV0FBQSxLQUNBVSxFQUFBSSxTQUFBSixFQUFBRyxJQUFBLEVBRUFKLEVBQUEvRCxLQUFBZ0UsS0FHQUQsRUFJQSxRQUFBTSxVQUFBWixHQUNBLE9BQUFBLEdBQ0EsSUFBQSxTQUNBLElBQUEsWUFDQSxJQUFBLFNBQ0EsTUFBQSxHQUNBLEtBQUEsZUFDQSxJQUFBLFVBQ0EsTUFBQSxLQUFBLElBS0EsUUFBQWEsb0JBQUFsQixFQUFBSyxHQUNBLE9BQUFBLEdBQ0EsSUFBQSxTQUNBLE1BQUFMLEVBQ0EsS0FBQSxZQUNBLE1BQUFBLEdBQUEsRUFDQSxLQUFBLGVBQ0EsTUFBQUEsSUFBQSxJQUFBLEVBQ0EsS0FBQSxVQUNBLE1BQUFBLElBQUEsSUFBQSxFQUNBLEtBQUEsU0FDQSxNQUFBQSxHQUFBLE1BS0EsUUFBQTlELGVBQUFGLEVBQUFDLEdBQ0EsR0FBQXlELE1BQ0FVLEtBS0FFLEVBQUEsV0FDQSxNQUFBLElBQUFaLEVBQUFwRCxPQUNBTixFQUFBTyxLQUFBbUQsR0FFQXpELEVBQUFxRSxnQkFDQTlELEtBQUEsU0FBQTJFLEdBRUEsTUFEQXpCLEdBQUFlLGlCQUFBVSxNQUtBeEIsRUFBQSxTQUFBQyxHQUNBQSxFQUFBSSxRQUFBa0IsbUJBQUF0QixFQUFBSSxRQUFBSixFQUFBRyxXQUFBL0IsTUFDQTRCLEVBQUFLLE1BQUFMLEVBQUFLLE1BQUFMLEVBQUFLLE1BQUFnQixTQUFBckIsRUFBQUcsV0FBQS9CLE1BRUEvQixFQUFBMEQsV0FBQUMsR0FDQXBELEtBQUEsU0FBQW9ELEdBQ0FGLEVBQUE5QyxLQUFBd0UsS0FBQVgsaUJBQUFiLEdBQUEsS0FDQSxTQUFBL0MsR0FDQUMsUUFBQUMsSUFBQUYsTUFLQTBELEVBQUEsV0FDQSxNQUFBLElBQUFILEVBQ0FwRSxFQUFBTyxLQUFBOEUsT0FFQXBGLEVBQUFzRSxvQkFDQS9ELEtBQUEsU0FBQThFLEdBRUEsTUFEQWxCLEdBQUFrQixLQUtBZCxFQUFBLFNBQUE3QyxHQUNBLE1BQUExQixHQUFBc0YsUUFBQTVELEdBQ0FuQixLQUFBLFNBQUF1RCxHQUNBLE1BQUFBLE1BTUF4QyxFQUFBLFNBQUFpRSxHQUNBLE1BQUE5QixHQUFBcEQsT0FBQSxHQUFBbUYsU0FBQS9CLEVBQUEsR0FBQThCLElBQ0E5QixFQUFBbEMsT0FBQSxTQUFBQyxFQUFBQyxHQUFBLE1BQUFELEdBQUFDLEVBQUE4RCxJQUFBLEdBREEsUUFJQUUsRUFBQSxTQUFBdkIsR0FDQSxNQUFBLElBQUFBLEVBQUFVLE9BR0FjLEVBQUEsU0FBQXhCLEdBQ0EsTUFBQSxJQUFBQSxFQUFBWSxLQUdBYSxFQUFBLFdBQ0EsTUFBQWxDLEdBQUFsQyxPQUFBLFNBQUFDLEVBQUFDLEdBQ0EsTUFBQUQsR0FBQWlFLEVBQUFoRSxJQUNBLElBR0FtRSxFQUFBLFdBQ0EsTUFBQW5DLEdBQUFsQyxPQUFBLFNBQUFDLEVBQUFDLEdBQ0EsTUFBQUQsR0FBQWtFLEVBQUFqRSxJQUNBLEdBSUFrQixNQUFBMEIsY0FBQUEsRUFDQTFCLEtBQUFlLFdBQUFBLEVBRUFmLEtBQUEyQixrQkFBQUEsRUFDQTNCLEtBQUE0QixjQUFBQSxFQUVBNUIsS0FBQThDLFlBQUFBLEVBQ0E5QyxLQUFBZ0QsaUJBQUFBLEVBQ0FoRCxLQUFBK0MsVUFBQUEsRUFDQS9DLEtBQUFpRCxlQUFBQSxFQUNBakQsS0FBQXJCLE1BQUFBLEVDNUlBLFFBQUF1RSx5QkFBQTVGLEVBQUFILEdBQ0EsR0FFQWdHLEdBQUEsV0FDQSxNQUFBN0YsR0FBQXFCLE1BQUEsT0FBQXhCLEVBQUFtQyxZQUdBOEQsRUFBQSxTQUFBQyxHQUNBLE1BQUFuRSxTQUFBb0UsU0FBQUQsR0FBQWxHLEVBQUE4QixZQUFBb0UsRUFBQWxHLEVBQUE4QixZQUdBZSxNQUFBbUQsV0FBQUEsRUFDQW5ELEtBQUF1RCxnQkFBQUgsRUNiQWxFLFFBQUFzRSxPQUFBLG1CQUFBLG1CQUNBQyxXQUFBLGtCQUFBLFNBQUEsU0FBQUMsR0FDQUEsRUFBQUMsZUFBQSw0QkNGQXpFLFFBQUFzRSxPQUFBLG9CQUNBSSxPQUFBLFNBQUEsV0FDQSxNQUFBLFVBQUFDLEVBQUFDLEdBQ0EsR0FBQTVFLFFBQUE0QyxRQUFBK0IsSUFBQTNFLFFBQUE2RSxTQUFBRCxHQUFBLENBR0EsSUFBQSxHQUZBRSxNQUNBQyxLQUNBQyxFQUFBLEVBQUFBLEVBQUFMLEVBQUFuRyxPQUFBd0csSUFBQSxDQUNBLEdBQUFDLEdBQUFOLEVBQUFLLEdBQUFKLEVBQ0E1RSxTQUFBa0YsWUFBQUgsRUFBQUUsTUFDQUYsRUFBQUUsSUFBQSxFQUNBSCxFQUFBaEcsS0FBQTZGLEVBQUFLLEtBSUEsTUFEQWhHLFNBQUFDLElBQUE2RixHQUNBQSxFQUVBLE1BQUFILE1DaEJBM0UsUUFBQXNFLE9BQUEsbUJBQ0FDLFdBQUEsb0JBQUEsZ0JBQUEsZ0JBQUEsU0FBQXRHLEVBQUFHLEdBQ0EsR0FBQWtGLEdBQUF4QyxJQUdBd0MsR0FBQWpGLFdBQ0FpRixFQUFBaEYsZUFHQUwsRUFBQU0sZ0JBQ0FHLEtBQUEsU0FBQUwsR0FDQWlGLEVBQUFqRixRQUFBQSxFQUNBSixFQUFBb0Isb0JBQ0FYLEtBQUEsU0FBQWlELEdBQ0EyQixFQUFBaEYsWUFBQXFELEdBQ0EsU0FBQTVDLEdBQ0FDLFFBQUFDLElBQUFGLE1BRUEsU0FBQUEsR0FDQUMsUUFBQUMsSUFBQUYsS0FNQXVFLEVBQUF6RSxhQUVBeUUsRUFBQTFFLFdBQUEsU0FBQUMsR0FDQVosRUFBQVcsV0FBQUMsR0FDQXlFLEVBQUF6RSxjQUdBeUUsRUFBQTlELGlCQUVBOEQsRUFBQS9ELGVBQUEsU0FBQUMsR0FDQXZCLEVBQUFzQixlQUFBQyxHQUNBOEQsRUFBQTlELGtCQUdBOEQsRUFBQWpELFVBQUFwQyxFQUFBb0MsVUFDQWlELEVBQUEvQyxrQkFBQXRDLEVBQUFzQyxrQkFDQStDLEVBQUE5QyxjQUFBdkMsRUFBQXVDLGNBQ0E4QyxFQUFBN0MsZUFBQXhDLEVBQUF3QyxlQUNBNkMsRUFBQTVDLGVBQUF6QyxFQUFBeUMsZUFDQTRDLEVBQUF6Qyx5QkFBQTVDLEVBQUE0Qyx5QkFDQXlDLEVBQUE3RCxNQUFBeEIsRUFBQXdCLFNOMEZBTyxRQUFBc0UsT0FBQSxtQkFDQWEsUUFBQSxpQkFBQSxLQUFBLGlCQUFBLGdCQUFBbEgsZ0JDU0ErQixRQUFBc0UsT0FBQSxtQkFDQWMsU0FBQSxVQUFBLHlCQUNBRCxRQUFBLGtCQUFBLFFBQUEsS0FBQSxVQUFBaEgsaUJNbkpBNkIsUUFBQXNFLE9BQUEsbUJBQ0FDLFdBQUEsb0JBQUEsZ0JBQ0EsU0FBQW5HLEdBQ0EsR0FBQWtGLEdBQUF4QyxJQUdBd0MsR0FBQTFCLFdBQ0EwQixFQUFBaEIsZUFHQWxFLEVBQUFvRSxnQkFDQTlELEtBQUEsU0FBQWtELEdBQ0EwQixFQUFBMUIsUUFBQUEsR0FDQSxTQUFBN0MsR0FDQUMsUUFBQUMsSUFBQUYsS0FJQVgsRUFBQXFFLG9CQUNBL0QsS0FBQSxTQUFBNEQsR0FDQWdCLEVBQUFoQixZQUFBQSxHQUNBLFNBQUF2RCxHQUNBQyxRQUFBQyxJQUFBRixLQUtBdUUsRUFBQXhCLGFBRUF3QixFQUFBekIsV0FBQSxTQUFBQyxHQUNBMUQsRUFBQXlELFdBQUFDLEdBQ0F3QixFQUFBeEIsY0FHQXdCLEVBQUFRLGlCQUFBMUYsRUFBQTBGLGlCQUNBUixFQUFBUyxlQUFBM0YsRUFBQTJGLGVBQ0FULEVBQUE3RCxNQUFBckIsRUFBQXFCLFNMNEdBTyxRQUFBc0UsT0FBQSxtQkFDQWEsUUFBQSxpQkFBQSxLQUFBLGlCQUFBL0csZ0JNakpBNEIsUUFBQXNFLE9BQUEsbUJBQ0FDLFdBQUEsOEJBQUEsMEJBQ0EsU0FBQVAsR0FDQSxHQUFBVixHQUFBeEMsSUFHQXdDLEdBQUFXLFdBQUFELEVBQUFDLFdBS0FYLEVBQUFZLGFBQUFGLEVBQUFLLG1CTEtBckUsUUFBQXNFLE9BQUEsbUJBQ0FhLFFBQUEsMkJBQUEsZ0JBQUEsZ0JBQUFuQiIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBidWRnZXRTZXJ2aWNlKCRxLCBkZXBsb3lkU2VydmljZSwgaW5jb21lU2VydmljZSkge1xyXG5cdHZhciBidWRnZXRzID0gW107XHJcblx0dmFyIGJ1ZGdldEl0ZW1zID0gW107XHJcblxyXG5cdC8vR2V0cyBhbmQgU2F2ZXMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHQvL2J1ZGdldHNcclxuXHR2YXIgZ2V0QWxsQnVkZ2V0cyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYoYnVkZ2V0cy5sZW5ndGggIT0gMCl7XHJcblx0XHRcdHJldHVybiAkcS53aGVuKGJ1ZGdldHMpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGRlcGxveWRTZXJ2aWNlLmdldEFsbEJ1ZGdldHMoKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbihhbGxCdWRnZXRzKSB7XHJcblx0XHRcdFx0YnVkZ2V0cyA9IGFsbEJ1ZGdldHM7XHJcblx0XHRcdFx0cmV0dXJuIGJ1ZGdldHM7XHJcblx0XHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdHZhciBzYXZlQnVkZ2V0ID0gZnVuY3Rpb24obmV3QnVkZ2V0KSB7XHJcblx0XHRkZXBsb3lkU2VydmljZS5zYXZlQnVkZ2V0KG5ld0J1ZGdldClcclxuXHRcdFx0LnRoZW4oZnVuY3Rpb24obmV3QnVkZ2V0KSB7XHJcblx0XHRcdFx0YnVkZ2V0cy5wdXNoKG5ld0J1ZGdldCk7XHJcblx0XHRcdH0sIGZ1bmN0aW9uKGVycikge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKGVycik7XHJcblx0XHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdHZhciBnZXRCdWRnZXQgPSBmdW5jdGlvbihidWRnZXRJZCkge1xyXG5cdFx0ZGVwbG95ZFNlcnZpY2UuZ2V0QnVkZ2V0KGJ1ZGdldElkKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbihidWRnZXQpIHtcclxuXHRcdFx0XHRyZXR1cm4gYnVkZ2V0O1xyXG5cdFx0XHR9LCBmdW5jdGlvbihlcnIpIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhlcnIpO1xyXG5cdFx0XHRcdHJldHVybiBudWxsO1xyXG5cdFx0XHR9KTtcclxuXHR9O1xyXG5cclxuXHQvL2J1ZGdldC1pdGVtc1xyXG5cdHZhciBnZXRBbGxCdWRnZXRJdGVtcyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYoYnVkZ2V0SXRlbXMubGVuZ3RoICE9IDApe1xyXG5cdFx0XHRyZXR1cm4gJHEud2hlbihidWRnZXRJdGVtcyk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gZGVwbG95ZFNlcnZpY2UuZ2V0QWxsQnVkZ2V0SXRlbXMoKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbihhbGxCdWRnZXRJdGVtcykge1xyXG5cdFx0XHRcdGJ1ZGdldEl0ZW1zID0gYWxsQnVkZ2V0SXRlbXM7XHJcblx0XHRcdFx0cmV0dXJuIGJ1ZGdldEl0ZW1zO1xyXG5cdFx0XHR9KTtcclxuXHR9O1xyXG5cclxuXHR2YXIgc2F2ZUJ1ZGdldEl0ZW0gPSBmdW5jdGlvbihuZXdCdWRnZXRJdGVtKSB7XHJcblx0XHRkZXBsb3lkU2VydmljZS5zYXZlQnVkZ2V0SXRlbShuZXdCdWRnZXRJdGVtKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbihuZXdCdWRnZXRJdGVtKSB7XHJcblx0XHRcdFx0YnVkZ2V0SXRlbXMucHVzaChuZXdCdWRnZXRJdGVtKTtcclxuXHRcdFx0fSwgZnVuY3Rpb24oZXJyKSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coZXJyKTtcclxuXHRcdFx0fSk7XHJcblx0fTtcclxuXHQvL0VuZCBHZXRzIGFuZCBTYXZlcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5cdC8vU3RhdGlzdGljcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHR2YXIgdG90YWwgPSBmdW5jdGlvbihidWRnZXQpIHtcclxuXHRcdHJldHVybiBidWRnZXRJdGVtcy5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgY3Vycikge1xyXG5cdFx0XHRpZihjdXJyLmJ1ZGdldElkID09IGJ1ZGdldC5pZClcclxuXHRcdFx0XHRyZXR1cm4gcHJldiArIGN1cnIuYW1vdW50O1xyXG5cdFx0XHRyZXR1cm4gcHJldjtcclxuXHRcdH0sIDApO1xyXG5cdH07XHJcblxyXG5cdHZhciB0b3RhbENvcmUgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciB0b3RhbENvcmUgPSAwO1xyXG5cclxuXHRcdGFuZ3VsYXIuZm9yRWFjaChidWRnZXRzLCBmdW5jdGlvbihidWRnZXQpIHtcclxuXHRcdFx0aWYoYnVkZ2V0Lm5hbWUgPT0gJ0ZpeGVkJyB8fCBidWRnZXQubmFtZSA9PSAnRmxleCcpIHtcclxuXHRcdFx0XHR2YXIgeCA9IHRvdGFsKGJ1ZGdldCk7XHJcblx0XHRcdFx0dG90YWxDb3JlICs9IHg7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdHJldHVybiB0b3RhbENvcmU7XHJcblx0fTtcclxuXHJcblx0dmFyIHRvdGFsQWxsID0gZnVuY3Rpb24oKSB7XHJcblx0XHRyZXR1cm4gYnVkZ2V0SXRlbXMucmVkdWNlKGZ1bmN0aW9uKHByZXYsIGN1cnIpIHtcclxuXHRcdFx0cmV0dXJuIHByZXYgKyBjdXJyLmFtb3VudDtcclxuXHRcdH0sIDApO1xyXG5cdH07XHJcblxyXG5cdHZhciBidWRnZXRDYXAgPSBmdW5jdGlvbihidWRnZXQpIHtcclxuXHRcdHJldHVybiBidWRnZXQucGVyY2VudEFsbG90bWVudCAvIDEwMCAqIGluY29tZVNlcnZpY2UudG90YWwoJ25ldCcpO1xyXG5cdH07XHJcblxyXG5cdHZhciBidWRnZXRVdGlsaXphdGlvbiA9IGZ1bmN0aW9uKGJ1ZGdldCkge1xyXG5cdFx0cmV0dXJuIHRvdGFsKGJ1ZGdldCkgLyBpbmNvbWVTZXJ2aWNlLnRvdGFsKCduZXQnKSAqIDEwMDtcclxuXHR9O1xyXG5cclxuXHR2YXIgYnVkZ2V0QmFsYW5jZSA9IGZ1bmN0aW9uKGJ1ZGdldCkge1xyXG5cdFx0cmV0dXJuIGJ1ZGdldENhcChidWRnZXQpIC0gdG90YWwoYnVkZ2V0KTtcclxuXHR9O1xyXG5cclxuXHR2YXIgZ3VpZGVsaW5lVG90YWwgPSBmdW5jdGlvbigpIHtcclxuXHRcdHJldHVybiBidWRnZXRzLnJlZHVjZShmdW5jdGlvbihwcmV2LCBjdXJyKSB7XHJcblx0XHRcdHJldHVybiBwcmV2ICsgY3Vyci5wZXJjZW50QWxsb3RtZW50O1xyXG5cdFx0fSwgMCk7XHJcblx0fTtcclxuXHJcblx0dmFyIHRheFV0aWxpemF0aW9uID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgZ3Jvc3NJbmNvbWUgPSBpbmNvbWVTZXJ2aWNlLnRvdGFsKCdncm9zcycpO1xyXG5cdFx0dmFyIG5ldEluY29tZSA9IGluY29tZVNlcnZpY2UudG90YWwoJ25ldCcpO1xyXG5cclxuXHRcdHJldHVybiAoZ3Jvc3NJbmNvbWUgLSBuZXRJbmNvbWUpIC8gZ3Jvc3NJbmNvbWU7XHJcblx0fTtcclxuXHJcblx0dmFyIG92ZXJ2aWV3VXRpbGl6YXRpb25Ub3RhbCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0cmV0dXJuIGJ1ZGdldHMucmVkdWNlKGZ1bmN0aW9uKHByZXYsIGN1cnIpIHtcclxuXHRcdFx0cmV0dXJuIHByZXYgKyBidWRnZXRVdGlsaXphdGlvbihjdXJyKTtcclxuXHRcdH0sIHRheFV0aWxpemF0aW9uKCkpO1xyXG5cdH07XHJcblx0Ly9FbmQgU3RhdGlzdGljcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuXHR0aGlzLmdldEFsbEJ1ZGdldHMgPSBnZXRBbGxCdWRnZXRzO1xyXG5cdHRoaXMuc2F2ZUJ1ZGdldCA9IHNhdmVCdWRnZXQ7XHJcblx0dGhpcy5nZXRCdWRnZXQgPSBnZXRCdWRnZXQ7XHJcblx0dGhpcy5nZXRBbGxCdWRnZXRJdGVtcyA9IGdldEFsbEJ1ZGdldEl0ZW1zO1xyXG5cdHRoaXMuc2F2ZUJ1ZGdldEl0ZW0gPSBzYXZlQnVkZ2V0SXRlbTtcclxuXHR0aGlzLnRvdGFsID0gdG90YWw7XHJcblx0dGhpcy50b3RhbENvcmUgPSB0b3RhbENvcmU7XHJcblx0dGhpcy50b3RhbEFsbCA9IHRvdGFsQWxsO1xyXG5cclxuXHR0aGlzLmJ1ZGdldENhcCA9IGJ1ZGdldENhcDtcclxuXHR0aGlzLmJ1ZGdldFV0aWxpemF0aW9uID0gYnVkZ2V0VXRpbGl6YXRpb247XHJcblx0dGhpcy5idWRnZXRCYWxhbmNlID0gYnVkZ2V0QmFsYW5jZTtcclxuXHR0aGlzLmd1aWRlbGluZVRvdGFsID0gZ3VpZGVsaW5lVG90YWw7XHJcblx0dGhpcy50YXhVdGlsaXphdGlvbiA9IHRheFV0aWxpemF0aW9uO1xyXG5cdHRoaXMub3ZlcnZpZXdVdGlsaXphdGlvblRvdGFsID0gb3ZlcnZpZXdVdGlsaXphdGlvblRvdGFsO1xyXG59XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnYnVkZ2V0dGluZ0lzRnVuJylcclxuXHQuc2VydmljZSgnYnVkZ2V0U2VydmljZScsIFsnJHEnLCAnZGVwbG95ZFNlcnZpY2UnLCAnaW5jb21lU2VydmljZScsIGJ1ZGdldFNlcnZpY2VdKTsiLCJmdW5jdGlvbiBkZXBsb3lkU2VydmljZSgkaHR0cCwgJHEsIGRlcGxveWQpIHtcclxuXHQvL2J1ZGdldHNcclxuXHR2YXIgYnVkZ2V0cyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHJcblx0XHQkaHR0cC5nZXQoZGVwbG95ZCArICcvYnVkZ2V0cycpXHJcblx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGJ1ZGdldHMpIHtcclxuXHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlKGJ1ZGdldHMpO1xyXG5cdFx0XHR9KS5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuXHRcdFx0XHRkZWZlcnJlZC5yZWplY3QoZXJyKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcblx0fTtcclxuXHJcblx0dmFyIHNhdmVCdWRnZXQgPSBmdW5jdGlvbihuZXdCdWRnZXQpIHtcclxuXHRcdHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcblxyXG5cdFx0JGh0dHAucG9zdChkZXBsb3lkICsgJy9idWRnZXRzJywge1xyXG5cdFx0XHRuYW1lOiBuZXdCdWRnZXQubmFtZSxcclxuXHRcdFx0cGVyY2VudEFsbG90bWVudDogbmV3QnVkZ2V0LnBlcmNlbnRcclxuXHRcdH0pLnN1Y2Nlc3MoZnVuY3Rpb24oYnVkZ2V0KSB7XHJcblx0XHRcdGRlZmVycmVkLnJlc29sdmUoYnVkZ2V0KTtcclxuXHRcdH0pLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG5cdFx0XHRkZWZlcnJlZC5yZWplY3QoZXJyKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG5cdH07XHJcblxyXG5cdHZhciBnZXRCdWRnZXQgPSBmdW5jdGlvbihidWRnZXRJZCkge1xyXG5cdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHJcblx0XHQkaHR0cC5nZXQoZGVwbG95ZCArICcvYnVkZ2V0cycsIHtcclxuXHRcdFx0aWQ6IGJ1ZGdldElkXHJcblx0XHR9KS5zdWNjZXNzKGZ1bmN0aW9uKGJ1ZGdldCl7XHJcblx0XHRcdGRlZmVycmVkLnJlc29sdmUoYnVkZ2V0KTtcclxuXHRcdH0pLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG5cdFx0XHRkZWZlcnJlZC5yZWplY3QoZXJyKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG5cdH07XHJcblxyXG5cdHZhciBidWRnZXRJdGVtcyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHJcblx0XHQkaHR0cC5nZXQoZGVwbG95ZCArICcvYnVkZ2V0LWl0ZW1zJylcclxuXHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24oaXRlbXMpIHtcclxuXHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlKGl0ZW1zKTtcclxuXHRcdFx0fSkuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coZXJyKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcblx0fTtcclxuXHJcblx0dmFyIHNhdmVCdWRnZXRJdGVtID0gZnVuY3Rpb24obmV3QnVkZ2V0SXRlbSkge1xyXG5cdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHJcblx0XHQkaHR0cC5wb3N0KGRlcGxveWQgKyAnL2J1ZGdldC1pdGVtcycsIHtcclxuXHRcdFx0bmFtZTogbmV3QnVkZ2V0SXRlbS5uYW1lLFxyXG5cdFx0XHRhbW91bnQ6IG5ld0J1ZGdldEl0ZW0uYW1vdW50LFxyXG5cdFx0XHRidWRnZXRJZDogbmV3QnVkZ2V0SXRlbS5idWRnZXQuaWRcclxuXHRcdH0pLnN1Y2Nlc3MoZnVuY3Rpb24obmV3QnVkZ2V0SXRlbSkge1xyXG5cdFx0XHRkZWZlcnJlZC5yZXNvbHZlKG5ld0J1ZGdldEl0ZW0pO1xyXG5cdFx0fSkuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcblx0XHRcdGRlZmVycmVkLnJlamVjdChlcnIpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcblx0fTtcclxuXHJcblx0Ly9pbmNvbWVzXHJcblx0dmFyIGluY29tZXMgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcblxyXG5cdFx0JGh0dHAuZ2V0KGRlcGxveWQgKyAnL2luY29tZS1zb3VyY2VzJylcclxuXHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24oaW5jb21lcykge1xyXG5cdFx0XHRcdGRlZmVycmVkLnJlc29sdmUoaW5jb21lcyk7XHJcblx0XHRcdH0pLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG5cdFx0XHRcdGRlZmVycmVkLnJlamVjdChlcnIpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRyZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuXHR9O1xyXG5cclxuXHR2YXIgc2F2ZUluY29tZSA9IGZ1bmN0aW9uKG5ld0luY29tZSkge1xyXG5cdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHJcblx0XHQkaHR0cC5wb3N0KGRlcGxveWQgKyAnL2luY29tZS1zb3VyY2VzJywge1xyXG5cdFx0XHRqb2I6IG5ld0luY29tZS5qb2IsXHJcblx0XHRcdGluY29tZVR5cGVJZDogbmV3SW5jb21lLmluY29tZVR5cGUuaWQsXHJcblx0XHRcdHBheXJhdGU6IG5ld0luY29tZS5wYXlyYXRlLFxyXG5cdFx0XHRob3VyczogbmV3SW5jb21lLmhvdXJzLFxyXG5cdFx0XHR0YXhQZXJjZW50OiBuZXdJbmNvbWUudGF4UGVyY2VudFxyXG5cdFx0fSkuc3VjY2VzcyhmdW5jdGlvbihpbmNvbWUpIHtcclxuXHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShpbmNvbWUpO1xyXG5cdFx0fSkuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcblx0XHRcdGRlZmVycmVkLnJlamVjdChlcnIpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcblx0fTtcclxuXHJcblx0Ly9pbmNvbWUtdHlwZXNcclxuXHR2YXIgaW5jb21lVHlwZXMgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcblxyXG5cdFx0JGh0dHAuZ2V0KGRlcGxveWQgKyAnL2luY29tZS10eXBlcycpXHJcblx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGluY29tZVR5cGVzKSB7XHJcblx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShpbmNvbWVUeXBlcyk7XHJcblx0XHRcdH0pLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG5cdFx0XHRcdGRlZmVycmVkLnJlamVjdChlcnIpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRyZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuXHR9XHJcblxyXG5cdHZhciBpbmNvbWVUeXBlID0gZnVuY3Rpb24oaWQpIHtcclxuXHRcdHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcblxyXG5cdFx0JGh0dHAuZ2V0KGRlcGxveWQgKyAnL2luY29tZS10eXBlcz9pZD0nICsgaWQpXHJcblx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGluY29tZVR5cGUpIHtcclxuXHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlKHR5cGUpO1xyXG5cdFx0XHR9KS5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhlcnIpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG5cdH07XHJcblxyXG5cdHRoaXMuZ2V0QWxsQnVkZ2V0cyA9IGJ1ZGdldHM7XHJcblx0dGhpcy5zYXZlQnVkZ2V0ID0gc2F2ZUJ1ZGdldDtcclxuXHR0aGlzLmdldEFsbEJ1ZGdldEl0ZW1zID0gYnVkZ2V0SXRlbXM7XHJcblx0dGhpcy5zYXZlQnVkZ2V0SXRlbSA9IHNhdmVCdWRnZXRJdGVtO1xyXG5cdHRoaXMuZ2V0QnVkZ2V0ID0gZ2V0QnVkZ2V0O1xyXG5cclxuXHR0aGlzLmdldEFsbEluY29tZXMgPSBpbmNvbWVzO1xyXG5cdHRoaXMuc2F2ZUluY29tZSA9IHNhdmVJbmNvbWU7XHJcblxyXG5cdHRoaXMuZ2V0QWxsSW5jb21lVHlwZXMgPSBpbmNvbWVUeXBlcztcclxuXHR0aGlzLmdldEluY29tZVR5cGUgPSBpbmNvbWVUeXBlO1xyXG59XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnYnVkZ2V0dGluZ0lzRnVuJylcclxuXHQuY29uc3RhbnQoJ2RlcGxveWQnLCAnaHR0cDovL2xvY2FsaG9zdDoyNDAzJylcclxuXHQuc2VydmljZSgnZGVwbG95ZFNlcnZpY2UnLCBbJyRodHRwJywgJyRxJywgJ2RlcGxveWQnLCBkZXBsb3lkU2VydmljZV0pOyIsIi8vbm9ybWFsaXplIGluY29tZSBmbGVzaGluZyBvdXQgZ3Jvc3MgYW5kIG5ldCBudW1iZXJzXHJcbmZ1bmN0aW9uIG5vcm1hbGl6ZUluY29tZXMoaW5jb21lcykge1xyXG5cdGlmKCFhbmd1bGFyLmlzQXJyYXkoaW5jb21lcykpXHJcblx0XHRpbmNvbWVzID0gW2luY29tZXNdO1xyXG5cclxuXHR2YXIgbm9ybWFsaXplZEluY29tZXMgPSBbXTtcclxuXHJcblx0YW5ndWxhci5mb3JFYWNoKGluY29tZXMsIGZ1bmN0aW9uKGluY29tZSkge1xyXG5cdFx0dmFyIG5vcm1JbmNvbWUgPSB7fTtcclxuXHJcblx0XHRub3JtSW5jb21lLmpvYiA9IGluY29tZS5qb2I7XHJcblx0XHRub3JtSW5jb21lLnBheXJhdGUgPSBpbmNvbWUucGF5cmF0ZTtcclxuXHRcdG5vcm1JbmNvbWUuaG91cnMgPSBpbmNvbWUuaG91cnM7XHJcblx0XHRub3JtSW5jb21lLmdyb3NzID0gaW5jb21lLnBheXJhdGUgKiBpbmNvbWUuaG91cnMgKiA0O1xyXG5cdFx0bm9ybUluY29tZS50YXggPSBpbmNvbWUudGF4UGVyY2VudDtcclxuXHRcdG5vcm1JbmNvbWUubmV0ID0gbm9ybUluY29tZS5ncm9zcyAqICgxIC0gKGluY29tZS50YXhQZXJjZW50IC8gMTAwKSk7XHJcblx0XHRub3JtSW5jb21lLmJpd2Vla2x5ID0gbm9ybUluY29tZS5uZXQgLyAyO1xyXG5cclxuXHRcdG5vcm1hbGl6ZWRJbmNvbWVzLnB1c2gobm9ybUluY29tZSk7XHJcblx0fSlcclxuXHJcblx0cmV0dXJuIG5vcm1hbGl6ZWRJbmNvbWVzO1xyXG59XHJcblxyXG4vL3JldHVybiBob3VycyBiYXNlZCBvbiBpbmNvbWUgdHlwZVxyXG5mdW5jdGlvbiBnZXRIb3Vycyh0eXBlKSB7XHJcblx0c3dpdGNoKHR5cGUpe1xyXG5cdFx0Y2FzZSAnV2Vla2x5JzpcclxuXHRcdGNhc2UgJ0JpLVdlZWtseSc6XHJcblx0XHRjYXNlICdZZWFybHknOlxyXG5cdFx0XHRyZXR1cm4gNDA7XHJcblx0XHRjYXNlICdTZW1pLU1vbnRobHknOlxyXG5cdFx0Y2FzZSAnTW9udGhseSc6XHJcblx0XHRcdHJldHVybiAoNDAqMTMvMTIpOyAvLzEzIHdlZWsgbW9udGhzIGluIDEyIG1vbnRocyBiYXNlZCBvbiA1MiB3ZWVrcy95ZWFyXHJcblx0fVxyXG59XHJcblxyXG4vL3JldHVybnMgcGF5cmF0ZSBhZGp1c3RlZCB0byA0MCBob3VyL3dlZWsgcmF0ZVxyXG5mdW5jdGlvbiBnZXRBZGp1c3RlZFBheXJhdGUocGF5cmF0ZSwgdHlwZSl7XHJcblx0c3dpdGNoKHR5cGUpe1xyXG5cdFx0Y2FzZSAnV2Vla2x5JzpcclxuXHRcdFx0cmV0dXJuIHBheXJhdGU7IC8vZG8gbm90aGluZyBwYXlyYXRlIGlzIHdoYXQgaXQgaXNcclxuXHRcdGNhc2UgJ0JpLVdlZWtseSc6XHJcblx0XHRcdHJldHVybiBwYXlyYXRlIC8gODA7IC8vODAgaG91cnMgaW4gMiB3ZWVrc1xyXG5cdFx0Y2FzZSAnU2VtaS1Nb250aGx5JzpcclxuXHRcdFx0cmV0dXJuIHBheXJhdGUgLyAoNDAqMTMvNik7IC8vODYuNjY2NiBob3VycyBpbiBhIHNlbWktbW9udGhcclxuXHRcdGNhc2UgJ01vbnRobHknOlxyXG5cdFx0XHRyZXR1cm4gcGF5cmF0ZSAvICg0MCoxMy8zKTsgLy8xNzMuMzMzMyBob3VycyBpbiBhIG1vbnRoXHJcblx0XHRjYXNlICdZZWFybHknOlxyXG5cdFx0XHRyZXR1cm4gcGF5cmF0ZSAvIDIwODA7IC8vLzIwODAgaG91cnMgaW4gYSB5ZWFyXHJcblx0fVxyXG59XHJcblxyXG4vL2luY29tZSBzZXJ2aWNlIHByb3ZpZGVzIG1ldGhvZHMgdG8gYWRkIGFuZCBnZXQgaW5jb21lc1xyXG5mdW5jdGlvbiBpbmNvbWVTZXJ2aWNlKCRxLCBkZXBsb3lkU2VydmljZSkge1xyXG5cdHZhciBpbmNvbWVzID0gW107XHJcblx0dmFyIGluY29tZVR5cGVzID0gW107XHJcblxyXG5cdFxyXG5cdC8vR2V0cyBhbmQgU2F2ZXMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHQvL2luY29tZXNcclxuXHR2YXIgZ2V0QWxsSW5jb21lcyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYoaW5jb21lcy5sZW5ndGggIT0gMCl7XHJcblx0XHRcdHJldHVybiAkcS53aGVuKGluY29tZXMpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGRlcGxveWRTZXJ2aWNlLmdldEFsbEluY29tZXMoKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbihhbGxJbmNvbWVzKSB7XHJcblx0XHRcdFx0aW5jb21lcyA9IG5vcm1hbGl6ZUluY29tZXMoYWxsSW5jb21lcyk7XHJcblx0XHRcdFx0cmV0dXJuIGluY29tZXM7XHJcblx0XHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdHZhciBzYXZlSW5jb21lID0gZnVuY3Rpb24obmV3SW5jb21lKXtcclxuXHRcdG5ld0luY29tZS5wYXlyYXRlID0gZ2V0QWRqdXN0ZWRQYXlyYXRlKG5ld0luY29tZS5wYXlyYXRlLCBuZXdJbmNvbWUuaW5jb21lVHlwZS5uYW1lKTtcclxuXHRcdG5ld0luY29tZS5ob3VycyA9ICghbmV3SW5jb21lLmhvdXJzKSA/IGdldEhvdXJzKG5ld0luY29tZS5pbmNvbWVUeXBlLm5hbWUpIDogbmV3SW5jb21lLmhvdXJzO1xyXG5cclxuXHRcdGRlcGxveWRTZXJ2aWNlLnNhdmVJbmNvbWUobmV3SW5jb21lKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbihuZXdJbmNvbWUpIHtcclxuXHRcdFx0XHRpbmNvbWVzLnB1c2goc2VsZi5ub3JtYWxpemVJbmNvbWVzKG5ld0luY29tZSlbMF0pO1xyXG5cdFx0XHR9LCBmdW5jdGlvbihlcnIpIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhlcnIpXHJcblx0XHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdC8vaW5jb21lLXR5cGVzXHJcblx0dmFyIGdldEFsbEluY29tZVR5cGVzID0gZnVuY3Rpb24oKSB7XHJcblx0XHRpZihpbmNvbWVUeXBlcyAhPSAwKXtcclxuXHRcdFx0cmV0dXJuICRxLndoZW4odHlwZXMpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGRlcGxveWRTZXJ2aWNlLmdldEFsbEluY29tZVR5cGVzKClcclxuXHRcdFx0LnRoZW4oZnVuY3Rpb24oYWxsSW5jb21lVHlwZXMpIHtcclxuXHRcdFx0XHRpbmNvbWVUeXBlcyA9IGFsbEluY29tZVR5cGVzO1xyXG5cdFx0XHRcdHJldHVybiBpbmNvbWVUeXBlcztcclxuXHRcdFx0fSk7XHJcblx0fTtcclxuXHJcblx0dmFyIGdldEluY29tZVR5cGUgPSBmdW5jdGlvbihpZCkge1xyXG5cdFx0cmV0dXJuIGRlcGxveWRTZXJ2aWNlLmdldFR5cGUoaWQpXHJcblx0XHRcdC50aGVuKGZ1bmN0aW9uKGluY29tZVR5cGUpIHtcclxuXHRcdFx0XHRyZXR1cm4gaW5jb21lVHlwZTtcclxuXHRcdFx0fSk7XHJcblx0fTtcclxuXHQvL0VuZCBHZXRzIGFuZCBTYXZlcy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5cdC8vU3RhdGlzdGljcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHR2YXIgdG90YWwgPSBmdW5jdGlvbihwcm9wZXJ0eSkge1xyXG5cdFx0aWYoaW5jb21lcy5sZW5ndGggPiAwICYmIGlzRmluaXRlKGluY29tZXNbMF1bcHJvcGVydHldKSlcclxuXHRcdFx0cmV0dXJuIGluY29tZXMucmVkdWNlKGZ1bmN0aW9uKHByZXYsIGN1cnIpIHsgcmV0dXJuIHByZXYgKyBjdXJyW3Byb3BlcnR5XTsgfSwgMCk7XHJcblx0fTtcclxuXHJcblx0dmFyIHllYXJseUdyb3NzID0gZnVuY3Rpb24oaW5jb21lKSB7XHJcblx0XHRyZXR1cm4gaW5jb21lLmdyb3NzICogMTM7IC8vMTMgd2VlayBtb250aHMgaW4gYSB5ZWFyICg1MiB3ZWVrcylcclxuXHR9O1xyXG5cclxuXHR2YXIgeWVhcmx5TmV0ID0gZnVuY3Rpb24oaW5jb21lKSB7XHJcblx0XHRyZXR1cm4gaW5jb21lLm5ldCAqIDEzO1xyXG5cdH07XHJcblxyXG5cdHZhciB0b3RhbFllYXJseUdyb3NzID0gZnVuY3Rpb24oKSB7XHJcblx0XHRyZXR1cm4gaW5jb21lcy5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgY3Vycikge1xyXG5cdFx0XHRyZXR1cm4gcHJldiArIHllYXJseUdyb3NzKGN1cnIpO1xyXG5cdFx0fSwgMCk7XHJcblx0fTtcclxuXHJcblx0dmFyIHRvdGFsWWVhcmx5TmV0ID0gZnVuY3Rpb24oKSB7XHJcblx0XHRyZXR1cm4gaW5jb21lcy5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgY3Vycikge1xyXG5cdFx0XHRyZXR1cm4gcHJldiArIHllYXJseU5ldChjdXJyKTtcclxuXHRcdH0sIDApO1xyXG5cdH07XHJcblx0Ly9FbmQgU3RhdGlzdGljcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuXHR0aGlzLmdldEFsbEluY29tZXMgPSBnZXRBbGxJbmNvbWVzO1xyXG5cdHRoaXMuc2F2ZUluY29tZSA9IHNhdmVJbmNvbWU7XHJcblxyXG5cdHRoaXMuZ2V0QWxsSW5jb21lVHlwZXMgPSBnZXRBbGxJbmNvbWVUeXBlcztcclxuXHR0aGlzLmdldEluY29tZVR5cGUgPSBnZXRJbmNvbWVUeXBlO1xyXG5cclxuXHR0aGlzLnllYXJseUdyb3NzID0geWVhcmx5R3Jvc3M7XHJcblx0dGhpcy50b3RhbFllYXJseUdyb3NzID0gdG90YWxZZWFybHlHcm9zcztcclxuXHR0aGlzLnllYXJseU5ldCA9IHllYXJseU5ldDtcclxuXHR0aGlzLnRvdGFsWWVhcmx5TmV0ID0gdG90YWxZZWFybHlOZXQ7XHJcblx0dGhpcy50b3RhbCA9IHRvdGFsO1xyXG59XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnYnVkZ2V0dGluZ0lzRnVuJylcclxuXHQuc2VydmljZSgnaW5jb21lU2VydmljZScsIFsnJHEnLCAnZGVwbG95ZFNlcnZpY2UnLCBpbmNvbWVTZXJ2aWNlXSk7IiwiLy9wcm9qZWN0ZWQgYmFsYW5jZSBzZXJ2aWNlXHJcbmZ1bmN0aW9uIHByb2plY3RlZEJhbGFuY2VTZXJ2aWNlKGluY29tZVNlcnZpY2UsIGJ1ZGdldFNlcnZpY2UpIHtcclxuXHR2YXIgYmFsYW5jZSA9IDA7XHJcblxyXG5cdHZhciBnZXRCYWxhbmNlID0gZnVuY3Rpb24oKSB7XHJcblx0XHRyZXR1cm4gaW5jb21lU2VydmljZS50b3RhbCgnbmV0JykgLSBidWRnZXRTZXJ2aWNlLnRvdGFsQWxsKCk7XHJcblx0fTtcclxuXHJcblx0dmFyIGNvcmVFeHBlbnNlcyA9IGZ1bmN0aW9uKG11bHRpcGxlKSB7XHJcblx0XHRyZXR1cm4gKGFuZ3VsYXIuaXNOdW1iZXIobXVsdGlwbGUpKSA/IGJ1ZGdldFNlcnZpY2UudG90YWxDb3JlKCkgKiBtdWx0aXBsZSA6IGJ1ZGdldFNlcnZpY2UudG90YWxDb3JlKCk7XHJcblx0fTtcclxuXHJcblx0dGhpcy5nZXRCYWxhbmNlID0gZ2V0QmFsYW5jZTtcclxuXHR0aGlzLmdldENvcmVFeHBlbnNlcyA9IGNvcmVFeHBlbnNlcztcclxufVxyXG5cclxuYW5ndWxhci5tb2R1bGUoJ2J1ZGdldHRpbmdJc0Z1bicpXHJcblx0LnNlcnZpY2UoJ3Byb2plY3RlZEJhbGFuY2VTZXJ2aWNlJywgWydpbmNvbWVTZXJ2aWNlJywgJ2J1ZGdldFNlcnZpY2UnLCBwcm9qZWN0ZWRCYWxhbmNlU2VydmljZV0pOyIsImFuZ3VsYXIubW9kdWxlKCdidWRnZXR0aW5nSXNGdW4nLCBbJ2FuZ3VsYXIuZmlsdGVyJ10pXHJcblx0LmNvbnRyb2xsZXIoJ0Jhc2VDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcclxuXHRcdCRzY29wZS53ZWxjb21lTWVzc2FnZSA9ICdXZWxjb21lIFNhdnkgQnVkZ2V0dGVyJztcclxuXHR9XSk7IiwiYW5ndWxhci5tb2R1bGUoXCJjdXN0b21GaWx0ZXJzXCIsIFtdKVxyXG4gICAgLmZpbHRlcihcInVuaXF1ZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChkYXRhLCBwcm9wZXJ0eU5hbWUpIHtcclxuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSAmJiBhbmd1bGFyLmlzU3RyaW5nKHByb3BlcnR5TmFtZSkpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gW107XHJcbiAgICAgICAgICAgICAgICB2YXIga2V5cyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbCA9IGRhdGFbaV1bcHJvcGVydHlOYW1lXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChrZXlzW3ZhbF0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleXNbdmFsXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChkYXRhW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHRzKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdidWRnZXR0aW5nSXNGdW4nKVxyXG5cdC5jb250cm9sbGVyKCdCdWRnZXRDb250cm9sbGVyJywgWydidWRnZXRTZXJ2aWNlJywgJ2luY29tZVNlcnZpY2UnLCBmdW5jdGlvbihidWRnZXRTZXJ2aWNlLCBpbmNvbWVTZXJ2aWNlKSB7XHJcblx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gIFx0XHQvL2luaXQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cdFx0c2VsZi5idWRnZXRzID0gW107XHJcblx0XHRzZWxmLmJ1ZGdldEl0ZW1zID0gW107XHJcbiAgXHRcdFxyXG4gIFx0XHQvL0dldCBidWRnZXRzIGFuZCBidWRnZXQgaXRlbXNcclxuICBcdFx0YnVkZ2V0U2VydmljZS5nZXRBbGxCdWRnZXRzKClcclxuICBcdFx0XHQudGhlbihmdW5jdGlvbihidWRnZXRzKSB7XHJcbiAgXHRcdFx0XHRzZWxmLmJ1ZGdldHMgPSBidWRnZXRzO1xyXG4gIFx0XHRcdFx0YnVkZ2V0U2VydmljZS5nZXRBbGxCdWRnZXRJdGVtcygpXHJcbiAgXHRcdFx0XHRcdC50aGVuKGZ1bmN0aW9uKGl0ZW1zKSB7XHJcbiAgXHRcdFx0XHRcdFx0c2VsZi5idWRnZXRJdGVtcyA9IGl0ZW1zO1xyXG4gIFx0XHRcdFx0XHR9LCBmdW5jdGlvbihlcnIpIHtcclxuICBcdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhlcnIpO1xyXG4gIFx0XHRcdFx0XHR9KTtcclxuICBcdFx0XHR9LCBmdW5jdGlvbihlcnIpIHtcclxuICBcdFx0XHRcdGNvbnNvbGUubG9nKGVycik7XHJcbiAgXHRcdFx0fSk7XHJcblxyXG4gIFx0XHQvL2luaXQgZW5kLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICBcdFx0Ly9hY3Rpb25zLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHRcdHNlbGYubmV3QnVkZ2V0ID0ge307XHJcblxyXG5cdFx0c2VsZi5zYXZlQnVkZ2V0ID0gZnVuY3Rpb24obmV3QnVkZ2V0KSB7XHJcblx0XHRcdGJ1ZGdldFNlcnZpY2Uuc2F2ZUJ1ZGdldChuZXdCdWRnZXQpO1xyXG5cdFx0XHRzZWxmLm5ld0J1ZGdldCA9IHt9O1xyXG5cdFx0fTtcclxuXHJcblx0XHRzZWxmLm5ld0J1ZGdldEl0ZW0gPSB7fTtcclxuXHJcblx0XHRzZWxmLnNhdmVCdWRnZXRJdGVtID0gZnVuY3Rpb24obmV3QnVkZ2V0SXRlbSkge1xyXG5cdFx0XHRidWRnZXRTZXJ2aWNlLnNhdmVCdWRnZXRJdGVtKG5ld0J1ZGdldEl0ZW0pO1xyXG5cdFx0XHRzZWxmLm5ld0J1ZGdldEl0ZW0gPSB7fTtcclxuXHRcdH07XHJcblxyXG5cdFx0c2VsZi5idWRnZXRDYXAgPSBidWRnZXRTZXJ2aWNlLmJ1ZGdldENhcDtcclxuXHRcdHNlbGYuYnVkZ2V0VXRpbGl6YXRpb24gPSBidWRnZXRTZXJ2aWNlLmJ1ZGdldFV0aWxpemF0aW9uO1xyXG5cdFx0c2VsZi5idWRnZXRCYWxhbmNlID0gYnVkZ2V0U2VydmljZS5idWRnZXRCYWxhbmNlO1xyXG5cdFx0c2VsZi5ndWlkZWxpbmVUb3RhbCA9IGJ1ZGdldFNlcnZpY2UuZ3VpZGVsaW5lVG90YWw7XHJcblx0XHRzZWxmLnRheFV0aWxpemF0aW9uID0gYnVkZ2V0U2VydmljZS50YXhVdGlsaXphdGlvbjtcclxuXHRcdHNlbGYub3ZlcnZpZXdVdGlsaXphdGlvblRvdGFsID0gYnVkZ2V0U2VydmljZS5vdmVydmlld1V0aWxpemF0aW9uVG90YWw7XHJcblx0XHRzZWxmLnRvdGFsID0gYnVkZ2V0U2VydmljZS50b3RhbDtcclxuXHJcblx0XHQvL2FjdGlvbnMgZW5kLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cdH1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnYnVkZ2V0dGluZ0lzRnVuJylcclxuXHQuY29udHJvbGxlcignSW5jb21lQ29udHJvbGxlcicsIFsnaW5jb21lU2VydmljZScsIFxyXG5cdFx0ZnVuY3Rpb24oaW5jb21lU2VydmljZSkge1xyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG5cdFx0XHQvL2luaXQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblx0XHRcdHNlbGYuaW5jb21lcyA9IFtdO1xyXG5cdFx0XHRzZWxmLmluY29tZVR5cGVzID0gW107XHJcblxyXG5cdFx0XHQvL0dldCBpbmNvbWVzXHJcblx0XHRcdGluY29tZVNlcnZpY2UuZ2V0QWxsSW5jb21lcygpXHJcblx0XHRcdFx0LnRoZW4oZnVuY3Rpb24oaW5jb21lcykge1xyXG5cdFx0XHRcdFx0c2VsZi5pbmNvbWVzID0gaW5jb21lcztcclxuXHRcdFx0XHR9LCBmdW5jdGlvbihlcnIpIHtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKGVycik7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvL0dldCBpbmNvbWVUeXBlc1xyXG5cdFx0XHRpbmNvbWVTZXJ2aWNlLmdldEFsbEluY29tZVR5cGVzKClcclxuXHRcdFx0XHQudGhlbihmdW5jdGlvbihpbmNvbWVUeXBlcykge1xyXG5cdFx0XHRcdFx0c2VsZi5pbmNvbWVUeXBlcyA9IGluY29tZVR5cGVzO1xyXG5cdFx0XHRcdH0sIGZ1bmN0aW9uKGVycikge1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coZXJyKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0Ly9pbml0IGVuZC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuXHRcdFx0Ly9hY3Rpb25zLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cdFx0XHRzZWxmLm5ld0luY29tZSA9IHt9O1xyXG5cclxuXHRcdFx0c2VsZi5zYXZlSW5jb21lID0gZnVuY3Rpb24obmV3SW5jb21lKSB7XHJcblx0XHRcdFx0aW5jb21lU2VydmljZS5zYXZlSW5jb21lKG5ld0luY29tZSk7XHJcblx0XHRcdFx0c2VsZi5uZXdJbmNvbWUgPSB7fTtcclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdHNlbGYudG90YWxZZWFybHlHcm9zcyA9IGluY29tZVNlcnZpY2UudG90YWxZZWFybHlHcm9zcztcclxuXHRcdFx0c2VsZi50b3RhbFllYXJseU5ldCA9IGluY29tZVNlcnZpY2UudG90YWxZZWFybHlOZXQ7XHRcdFx0XHJcblx0XHRcdHNlbGYudG90YWwgPSBpbmNvbWVTZXJ2aWNlLnRvdGFsO1xyXG5cdFx0XHQvL2FjdGlvbnMgZW5kLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblx0fV0pOyIsImFuZ3VsYXIubW9kdWxlKCdidWRnZXR0aW5nSXNGdW4nKVxyXG5cdC5jb250cm9sbGVyKCdQcm9qZWN0ZWRCYWxhbmNlQ29udHJvbGxlcicsIFsncHJvamVjdGVkQmFsYW5jZVNlcnZpY2UnLCBcclxuXHRcdGZ1bmN0aW9uKHByb2plY3RlZEJhbGFuY2VTZXJ2aWNlKSB7XHJcblx0XHRcdHZhciBzZWxmID0gdGhpczsgXHJcblxyXG5cdFx0XHQvL2luaXQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblx0XHRcdHNlbGYuZ2V0QmFsYW5jZSA9IHByb2plY3RlZEJhbGFuY2VTZXJ2aWNlLmdldEJhbGFuY2U7XHJcblxyXG5cdFx0XHQvL2luaXQgZW5kLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5cdFx0XHQvL2FjdGlvbnMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblx0XHRcdHNlbGYuY29yZUV4cGVuc2VzID0gcHJvamVjdGVkQmFsYW5jZVNlcnZpY2UuZ2V0Q29yZUV4cGVuc2VzO1xyXG5cclxuXHRcdFx0Ly9hY3Rpb25zIGVuZC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cdH1dKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
