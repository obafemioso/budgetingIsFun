function budgetService(e,n){var t=[],o=[],r=function(){return 0!=t.length?e.when(t):n.getAllBudgets().then(function(e){return t=e})},u=function(){return 0!=o.length?e.when(o):n.getAllBudgetItems().then(function(e){return o=e})},c=function(e){n.saveBudget(e).then(function(e){t.push(e)},function(e){console.log(e)})},s=function(e){n.saveBudgetItem(e).then(function(e){o.push(e)},function(e){console.log(e)})},i=function(e){var n=0;return angular.forEach(o,function(t){t.budgetId==e&&(n+=t.amount)}),n};this.getAllBudgets=r,this.saveBudget=c,this.getAllBudgetItems=u,this.saveBudgetItem=s,this.total=i}function normalizeIncomes(e){angular.isArray(e)||(e=[e]);var n=[];return angular.forEach(e,function(e){var t={};t.job=e.job,t.payrate=e.payrate,t.hours=e.hours,t.gross=e.payrate*e.hours*4,t.tax=e.taxPercent,t.net=t.gross*(1-e.taxPercent/100),t.biweekly=t.net/2,n.push(t)}),n}function getHours(e){switch(e){case"Weekly":case"Bi-Weekly":case"Yearly":return 40;case"Semi-Monthly":case"Monthly":return 520/12}}function getAdjustedPayrate(e,n){switch(n){case"Weekly":return e;case"Bi-Weekly":return e/80;case"Semi-Monthly":return e/(520/6);case"Monthly":return e/(520/3);case"Yearly":return e/2080}}function incomeService(e,n){var t=[],o=[],r=function(){return 0!=t.length?e.when(t):n.getAllIncomes().then(function(e){return t=normalizeIncomes(e)})},u=function(e){e.payrate=getAdjustedPayrate(e.payrate,e.incomeType.name),e.hours=e.hours?e.hours:getHours(e.incomeType.name),n.saveIncome(e).then(function(e){t.push(self.normalizeIncomes(e)[0])},function(e){console.log(e)})},c=function(){return 0!=o?e.when(types):n.getAllIncomeTypes().then(function(e){return o=e})},s=function(e){return n.getType(e).then(function(e){return e})};this.getAllIncomes=r,this.saveIncome=u,this.getAllIncomeTypes=c,this.getIncomeType=s}function deploydService(e,n,t){var o=function(){var o=n.defer();return e.get(t+"/budgets").success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},r=function(o){var r=n.defer();return e.post(t+"/budgets",{name:o.name,percentAllotment:o.percent}).success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise},u=function(){var o=n.defer();return e.get(t+"/budget-items").success(function(e){o.resolve(e)}).error(function(e){console.log(e)}),o.promise},c=function(o){var r=n.defer();return e.post(t+"/budget-items",{name:o.name,amount:o.amount,budgetId:o.budget.id}).success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise},s=function(){var o=n.defer();return e.get(t+"/income-sources").success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},i=function(o){var r=n.defer();return e.post(t+"/income-sources",{job:o.job,incomeTypeId:o.incomeType.id,payrate:o.payrate,hours:o.hours,taxPercent:o.taxPercent}).success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise},l=function(){var o=n.defer();return e.get(t+"/income-types").success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},a=function(o){var r=n.defer();return e.get(t+"/income-types?id="+o).success(function(e){r.resolve(type)}).error(function(e){console.log(e)}),r.promise};this.getAllBudgets=o,this.saveBudget=r,this.getAllBudgetItems=u,this.saveBudgetItem=c,this.getAllIncomes=s,this.saveIncome=i,this.getAllIncomeTypes=l,this.getIncomeType=a}angular.module("budgettingIsFun",["angular.filter"]).controller("BaseController",["$scope",function(e){e.welcomeMessage="Welcome Savy Budgetter"}]),angular.module("customFilters",[]).filter("unique",function(){return function(e,n){if(angular.isArray(e)&&angular.isString(n)){for(var t=[],o={},r=0;r<e.length;r++){var u=e[r][n];angular.isUndefined(o[u])&&(o[u]=!0,t.push(e[r]))}return console.log(t),t}return e}}),angular.module("budgettingIsFun").controller("BudgetController",["budgetService",function(e){var n=this;n.budgets=[],n.budgetItems=[],e.getAllBudgets().then(function(t){n.budgets=t,e.getAllBudgetItems().then(function(e){n.budgetItems=e},function(e){console.log(e)})},function(e){console.log(e)}),n.newBudget={},n.saveBudget=function(t){e.saveBudget(t),n.newBudget={}},n.newBudgetItem={},n.saveBudgetItem=function(t){e.saveBudgetItem(t),n.newBudgetItem={}},n.total=e.total}]),angular.module("budgettingIsFun").service("budgetService",["$q","deploydService",budgetService]),angular.module("budgettingIsFun").controller("IncomeController",["incomeService",function(e){var n=this;n.incomes=[],n.incomeTypes=[],e.getAllIncomes().then(function(e){n.incomes=e},function(e){console.log(e)}),e.getAllIncomeTypes().then(function(e){n.incomeTypes=e},function(e){console.log(e)}),n.newIncome={},n.saveIncome=function(t){e.saveIncome(t),n.newIncome={}}}]),angular.module("budgettingIsFun").service("incomeService",["$q","deploydService",incomeService]),angular.module("budgettingIsFun").constant("deployd","http://localhost:2403").service("deploydService",["$http","$q","deployd",deploydService]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvYnVkZ2V0L2J1ZGdldFNlcnZpY2UuanMiLCJjb21wb25lbnRzL2luY29tZS9pbmNvbWVTZXJ2aWNlLmpzIiwiY29tcG9uZW50cy9kZXBsb3lkL2RlcGxveWRTZXJ2aWNlLmpzIiwiYXBwLm1vZHVsZS5qcyIsImZpbHRlcnMvY3VzdG9tRmlsdGVycy5qcyIsImNvbXBvbmVudHMvYnVkZ2V0L2J1ZGdldENvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2luY29tZS9pbmNvbWVDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImJ1ZGdldFNlcnZpY2UiLCIkcSIsImRlcGxveWRTZXJ2aWNlIiwiYnVkZ2V0cyIsImJ1ZGdldEl0ZW1zIiwiZ2V0QWxsQnVkZ2V0cyIsImxlbmd0aCIsIndoZW4iLCJ0aGVuIiwiYWxsQnVkZ2V0cyIsImdldEFsbEJ1ZGdldEl0ZW1zIiwiYWxsQnVkZ2V0SXRlbXMiLCJzYXZlQnVkZ2V0IiwibmV3QnVkZ2V0IiwicHVzaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJzYXZlQnVkZ2V0SXRlbSIsIm5ld0J1ZGdldEl0ZW0iLCJ0b3RhbCIsImJ1ZGdldElkIiwiYW5ndWxhciIsImZvckVhY2giLCJidWRnZXRJdGVtIiwiYW1vdW50IiwidGhpcyIsIm5vcm1hbGl6ZUluY29tZXMiLCJpbmNvbWVzIiwiaXNBcnJheSIsIm5vcm1hbGl6ZWRJbmNvbWVzIiwiaW5jb21lIiwibm9ybUluY29tZSIsImpvYiIsInBheXJhdGUiLCJob3VycyIsImdyb3NzIiwidGF4IiwidGF4UGVyY2VudCIsIm5ldCIsImJpd2Vla2x5IiwiZ2V0SG91cnMiLCJ0eXBlIiwiZ2V0QWRqdXN0ZWRQYXlyYXRlIiwiaW5jb21lU2VydmljZSIsImluY29tZVR5cGVzIiwiZ2V0QWxsSW5jb21lcyIsImFsbEluY29tZXMiLCJzYXZlSW5jb21lIiwibmV3SW5jb21lIiwiaW5jb21lVHlwZSIsIm5hbWUiLCJzZWxmIiwiZ2V0QWxsSW5jb21lVHlwZXMiLCJ0eXBlcyIsImFsbEluY29tZVR5cGVzIiwiZ2V0SW5jb21lVHlwZSIsImlkIiwiZ2V0VHlwZSIsIiRodHRwIiwiZGVwbG95ZCIsImRlZmVycmVkIiwiZGVmZXIiLCJnZXQiLCJzdWNjZXNzIiwicmVzb2x2ZSIsImVycm9yIiwicmVqZWN0IiwicHJvbWlzZSIsInBvc3QiLCJwZXJjZW50QWxsb3RtZW50IiwicGVyY2VudCIsImJ1ZGdldCIsIml0ZW1zIiwiaW5jb21lVHlwZUlkIiwibW9kdWxlIiwiY29udHJvbGxlciIsIiRzY29wZSIsIndlbGNvbWVNZXNzYWdlIiwiZmlsdGVyIiwiZGF0YSIsInByb3BlcnR5TmFtZSIsImlzU3RyaW5nIiwicmVzdWx0cyIsImtleXMiLCJpIiwidmFsIiwiaXNVbmRlZmluZWQiLCJzZXJ2aWNlIiwiY29uc3RhbnQiXSwibWFwcGluZ3MiOiJBQUFBLFFBQUFBLGVBQUFDLEVBQUFDLEdBQ0EsR0FBQUMsTUFDQUMsS0FHQUMsRUFBQSxXQUNBLE1BQUEsSUFBQUYsRUFBQUcsT0FDQUwsRUFBQU0sS0FBQUosR0FFQUQsRUFBQUcsZ0JBQ0FHLEtBQUEsU0FBQUMsR0FFQSxNQURBTixHQUFBTSxLQUtBQyxFQUFBLFdBQ0EsTUFBQSxJQUFBTixFQUFBRSxPQUNBTCxFQUFBTSxLQUFBSCxHQUVBRixFQUFBUSxvQkFDQUYsS0FBQSxTQUFBRyxHQUVBLE1BREFQLEdBQUFPLEtBS0FDLEVBQUEsU0FBQUMsR0FDQVgsRUFBQVUsV0FBQUMsR0FDQUwsS0FBQSxTQUFBSyxHQUNBVixFQUFBVyxLQUFBRCxJQUNBLFNBQUFFLEdBQ0FDLFFBQUFDLElBQUFGLE1BSUFHLEVBQUEsU0FBQUMsR0FDQWpCLEVBQUFnQixlQUFBQyxHQUNBWCxLQUFBLFNBQUFXLEdBQ0FmLEVBQUFVLEtBQUFLLElBQ0EsU0FBQUosR0FDQUMsUUFBQUMsSUFBQUYsTUFJQUssRUFBQSxTQUFBQyxHQUNBLEdBQUFELEdBQUEsQ0FLQSxPQUpBRSxTQUFBQyxRQUFBbkIsRUFBQSxTQUFBb0IsR0FDQUEsRUFBQUgsVUFBQUEsSUFD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Q0FGLEtBQUEsU0FBQWlFLEdBQ0FyQixFQUFBaEQsWUFBQXFFLEdBQ0EsU0FBQTFELEdBQ0FDLFFBQUFDLElBQUFGLE1BRUEsU0FBQUEsR0FDQUMsUUFBQUMsSUFBQUYsS0FHQXFDLEVBQUF2QyxhQUVBdUMsRUFBQXhDLFdBQUEsU0FBQUMsR0FDQWIsRUFBQVksV0FBQUMsR0FDQXVDLEVBQUF2QyxjQUdBdUMsRUFBQWpDLGlCQUVBaUMsRUFBQWxDLGVBQUEsU0FBQUMsR0FDQW5CLEVBQUFrQixlQUFBQyxHQUNBaUMsRUFBQWpDLGtCQUdBaUMsRUFBQWhDLE1BQUFwQixFQUFBb0IsU0wyQkFFLFFBQUFxRCxPQUFBLG1CQUNBYSxRQUFBLGlCQUFBLEtBQUEsaUJBQUF4RixnQk05REFzQixRQUFBcUQsT0FBQSxtQkFDQUMsV0FBQSxvQkFBQSxnQkFDQSxTQUFBaEMsR0FDQSxHQUFBUSxHQUFBMUIsSUFFQTBCLEdBQUF4QixXQUNBd0IsRUFBQVAsZUFHQUQsRUFBQUUsZ0JBQ0F0QyxLQUFBLFNBQUFvQixHQUNBd0IsRUFBQXhCLFFBQUFBLEdBQ0EsU0FBQWIsR0FDQUMsUUFBQUMsSUFBQUYsS0FLQTZCLEVBQUFTLG9CQUNBN0MsS0FBQSxTQUFBcUMsR0FDQU8sRUFBQVAsWUFBQUEsR0FDQSxTQUFBOUIsR0FDQUMsUUFBQUMsSUFBQUYsS0FHQXFDLEVBQUFILGFBRUFHLEVBQUFKLFdBQUEsU0FBQUMsR0FDQUwsRUFBQUksV0FBQUMsR0FDQUcsRUFBQUgsaUJMK0VBM0IsUUFBQXFELE9BQUEsbUJBQ0FhLFFBQUEsaUJBQUEsS0FBQSxpQkFBQTVDLGdCQ3FCQXRCLFFBQUFxRCxPQUFBLG1CQUNBYyxTQUFBLFVBQUEseUJBQ0FELFFBQUEsa0JBQUEsUUFBQSxLQUFBLFVBQUF0RiIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBidWRnZXRTZXJ2aWNlKCRxLCBkZXBsb3lkU2VydmljZSkge1xyXG5cdHZhciBidWRnZXRzID0gW107XHJcblx0dmFyIGJ1ZGdldEl0ZW1zID0gW107XHJcblxyXG5cdC8vYnVkZ2V0c1xyXG5cdHZhciBnZXRBbGxCdWRnZXRzID0gZnVuY3Rpb24oKSB7XHJcblx0XHRpZihidWRnZXRzLmxlbmd0aCAhPSAwKXtcclxuXHRcdFx0cmV0dXJuICRxLndoZW4oYnVkZ2V0cyk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gZGVwbG95ZFNlcnZpY2UuZ2V0QWxsQnVkZ2V0cygpXHJcblx0XHRcdC50aGVuKGZ1bmN0aW9uKGFsbEJ1ZGdldHMpIHtcclxuXHRcdFx0XHRidWRnZXRzID0gYWxsQnVkZ2V0cztcclxuXHRcdFx0XHRyZXR1cm4gYnVkZ2V0cztcclxuXHRcdFx0fSk7XHJcblx0fTtcclxuXHJcblx0dmFyIGdldEFsbEJ1ZGdldEl0ZW1zID0gZnVuY3Rpb24oKSB7XHJcblx0XHRpZihidWRnZXRJdGVtcy5sZW5ndGggIT0gMCl7XHJcblx0XHRcdHJldHVybiAkcS53aGVuKGJ1ZGdldEl0ZW1zKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBkZXBsb3lkU2VydmljZS5nZXRBbGxCdWRnZXRJdGVtcygpXHJcblx0XHRcdC50aGVuKGZ1bmN0aW9uKGFsbEJ1ZGdldEl0ZW1zKSB7XHJcblx0XHRcdFx0YnVkZ2V0SXRlbXMgPSBhbGxCdWRnZXRJdGVtcztcclxuXHRcdFx0XHRyZXR1cm4gYnVkZ2V0SXRlbXM7XHJcblx0XHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdHZhciBzYXZlQnVkZ2V0ID0gZnVuY3Rpb24obmV3QnVkZ2V0KSB7XHJcblx0XHRkZXBsb3lkU2VydmljZS5zYXZlQnVkZ2V0KG5ld0J1ZGdldClcclxuXHRcdFx0LnRoZW4oZnVuY3Rpb24obmV3QnVkZ2V0KSB7XHJcblx0XHRcdFx0YnVkZ2V0cy5wdXNoKG5ld0J1ZGdldCk7XHJcblx0XHRcdH0sIGZ1bmN0aW9uKGVycikge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKGVycik7XHJcblx0XHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdHZhciBzYXZlQnVkZ2V0SXRlbSA9IGZ1bmN0aW9uKG5ld0J1ZGdldEl0ZW0pIHtcclxuXHRcdGRlcGxveWRTZXJ2aWNlLnNhdmVCdWRnZXRJdGVtKG5ld0J1ZGdldEl0ZW0pXHJcblx0XHRcdC50aGVuKGZ1bmN0aW9uKG5ld0J1ZGdldEl0ZW0pIHtcclxuXHRcdFx0XHRidWRnZXRJdGVtcy5wdXNoKG5ld0J1ZGdldEl0ZW0pO1xyXG5cdFx0XHR9LCBmdW5jdGlvbihlcnIpIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhlcnIpO1xyXG5cdFx0XHR9KTtcclxuXHR9O1xyXG5cclxuXHR2YXIgdG90YWwgPSBmdW5jdGlvbihidWRnZXRJZCkge1xyXG5cdFx0dmFyIHRvdGFsID0gMDtcclxuXHRcdGFuZ3VsYXIuZm9yRWFjaChidWRnZXRJdGVtcywgZnVuY3Rpb24oYnVkZ2V0SXRlbSkge1xyXG5cdFx0XHRpZihidWRnZXRJdGVtLmJ1ZGdldElkID09IGJ1ZGdldElkKVxyXG5cdFx0XHRcdHRvdGFsICs9IGJ1ZGdldEl0ZW0uYW1vdW50O1xyXG5cdFx0fSk7XHJcblx0XHRyZXR1cm4gdG90YWw7XHJcblx0fTtcclxuXHJcblx0dGhpcy5nZXRBbGxCdWRnZXRzID0gZ2V0QWxsQnVkZ2V0cztcclxuXHR0aGlzLnNhdmVCdWRnZXQgPSBzYXZlQnVkZ2V0O1xyXG5cdHRoaXMuZ2V0QWxsQnVkZ2V0SXRlbXMgPSBnZXRBbGxCdWRnZXRJdGVtcztcclxuXHR0aGlzLnNhdmVCdWRnZXRJdGVtID0gc2F2ZUJ1ZGdldEl0ZW07XHJcblx0dGhpcy50b3RhbCA9IHRvdGFsO1xyXG59XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnYnVkZ2V0dGluZ0lzRnVuJylcclxuXHQuc2VydmljZSgnYnVkZ2V0U2VydmljZScsIFsnJHEnLCAnZGVwbG95ZFNlcnZpY2UnLCBidWRnZXRTZXJ2aWNlXSk7IiwiLy9ub3JtYWxpemUgaW5jb21lIGZsZXNoaW5nIG91dCBncm9zcyBhbmQgbmV0IG51bWJlcnNcclxuZnVuY3Rpb24gbm9ybWFsaXplSW5jb21lcyhpbmNvbWVzKSB7XHJcblx0aWYoIWFuZ3VsYXIuaXNBcnJheShpbmNvbWVzKSlcclxuXHRcdGluY29tZXMgPSBbaW5jb21lc107XHJcblxyXG5cdHZhciBub3JtYWxpemVkSW5jb21lcyA9IFtdO1xyXG5cclxuXHRhbmd1bGFyLmZvckVhY2goaW5jb21lcywgZnVuY3Rpb24oaW5jb21lKSB7XHJcblx0XHR2YXIgbm9ybUluY29tZSA9IHt9O1xyXG5cclxuXHRcdG5vcm1JbmNvbWUuam9iID0gaW5jb21lLmpvYjtcclxuXHRcdG5vcm1JbmNvbWUucGF5cmF0ZSA9IGluY29tZS5wYXlyYXRlO1xyXG5cdFx0bm9ybUluY29tZS5ob3VycyA9IGluY29tZS5ob3VycztcclxuXHRcdG5vcm1JbmNvbWUuZ3Jvc3MgPSBpbmNvbWUucGF5cmF0ZSAqIGluY29tZS5ob3VycyAqIDQ7XHJcblx0XHRub3JtSW5jb21lLnRheCA9IGluY29tZS50YXhQZXJjZW50O1xyXG5cdFx0bm9ybUluY29tZS5uZXQgPSBub3JtSW5jb21lLmdyb3NzICogKDEgLSAoaW5jb21lLnRheFBlcmNlbnQgLyAxMDApKTtcclxuXHRcdG5vcm1JbmNvbWUuYml3ZWVrbHkgPSBub3JtSW5jb21lLm5ldCAvIDI7XHJcblxyXG5cdFx0bm9ybWFsaXplZEluY29tZXMucHVzaChub3JtSW5jb21lKTtcclxuXHR9KVxyXG5cclxuXHRyZXR1cm4gbm9ybWFsaXplZEluY29tZXM7XHJcbn1cclxuXHJcbi8vcmV0dXJuIGhvdXJzIGJhc2VkIG9uIGluY29tZSB0eXBlXHJcbmZ1bmN0aW9uIGdldEhvdXJzKHR5cGUpIHtcclxuXHRzd2l0Y2godHlwZSl7XHJcblx0XHRjYXNlICdXZWVrbHknOlxyXG5cdFx0Y2FzZSAnQmktV2Vla2x5JzpcclxuXHRcdGNhc2UgJ1llYXJseSc6XHJcblx0XHRcdHJldHVybiA0MDtcclxuXHRcdGNhc2UgJ1NlbWktTW9udGhseSc6XHJcblx0XHRjYXNlICdNb250aGx5JzpcclxuXHRcdFx0cmV0dXJuICg0MCoxMy8xMik7IC8vMTMgd2VlayBtb250aHMgaW4gMTIgbW9udGhzIGJhc2VkIG9uIDUyIHdlZWtzL3llYXJcclxuXHR9XHJcbn1cclxuXHJcbi8vcmV0dXJucyBwYXlyYXRlIGFkanVzdGVkIHRvIDQwIGhvdXIvd2VlayByYXRlXHJcbmZ1bmN0aW9uIGdldEFkanVzdGVkUGF5cmF0ZShwYXlyYXRlLCB0eXBlKXtcclxuXHRzd2l0Y2godHlwZSl7XHJcblx0XHRjYXNlICdXZWVrbHknOlxyXG5cdFx0XHRyZXR1cm4gcGF5cmF0ZTsgLy9kbyBub3RoaW5nIHBheXJhdGUgaXMgd2hhdCBpdCBpc1xyXG5cdFx0Y2FzZSAnQmktV2Vla2x5JzpcclxuXHRcdFx0cmV0dXJuIHBheXJhdGUgLyA4MDsgLy84MCBob3VycyBpbiAyIHdlZWtzXHJcblx0XHRjYXNlICdTZW1pLU1vbnRobHknOlxyXG5cdFx0XHRyZXR1cm4gcGF5cmF0ZSAvICg0MCoxMy82KTsgLy84Ni42NjY2IGhvdXJzIGluIGEgc2VtaS1tb250aFxyXG5cdFx0Y2FzZSAnTW9udGhseSc6XHJcblx0XHRcdHJldHVybiBwYXlyYXRlIC8gKDQwKjEzLzMpOyAvLzE3My4zMzMzIGhvdXJzIGluIGEgbW9udGhcclxuXHRcdGNhc2UgJ1llYXJseSc6XHJcblx0XHRcdHJldHVybiBwYXlyYXRlIC8gMjA4MDsgLy8vMjA4MCBob3VycyBpbiBhIHllYXJcclxuXHR9XHJcbn1cclxuXHJcbi8vaW5jb21lIHNlcnZpY2UgcHJvdmlkZXMgbWV0aG9kcyB0byBhZGQgYW5kIGdldCBpbmNvbWVzXHJcbmZ1bmN0aW9uIGluY29tZVNlcnZpY2UoJHEsIGRlcGxveWRTZXJ2aWNlKSB7XHJcblx0dmFyIGluY29tZXMgPSBbXTtcclxuXHR2YXIgaW5jb21lVHlwZXMgPSBbXTtcclxuXHJcblx0Ly9pbmNvbWVzXHJcblx0dmFyIGdldEFsbEluY29tZXMgPSBmdW5jdGlvbigpIHtcclxuXHRcdGlmKGluY29tZXMubGVuZ3RoICE9IDApe1xyXG5cdFx0XHRyZXR1cm4gJHEud2hlbihpbmNvbWVzKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBkZXBsb3lkU2VydmljZS5nZXRBbGxJbmNvbWVzKClcclxuXHRcdFx0LnRoZW4oZnVuY3Rpb24oYWxsSW5jb21lcykge1xyXG5cdFx0XHRcdGluY29tZXMgPSBub3JtYWxpemVJbmNvbWVzKGFsbEluY29tZXMpO1xyXG5cdFx0XHRcdHJldHVybiBpbmNvbWVzO1xyXG5cdFx0XHR9KTtcclxuXHR9O1xyXG5cclxuXHR2YXIgc2F2ZUluY29tZSA9IGZ1bmN0aW9uKG5ld0luY29tZSl7XHJcblx0XHRuZXdJbmNvbWUucGF5cmF0ZSA9IGdldEFkanVzdGVkUGF5cmF0ZShuZXdJbmNvbWUucGF5cmF0ZSwgbmV3SW5jb21lLmluY29tZVR5cGUubmFtZSk7XHJcblx0XHRuZXdJbmNvbWUuaG91cnMgPSAoIW5ld0luY29tZS5ob3VycykgPyBnZXRIb3VycyhuZXdJbmNvbWUuaW5jb21lVHlwZS5uYW1lKSA6IG5ld0luY29tZS5ob3VycztcclxuXHJcblx0XHRkZXBsb3lkU2VydmljZS5zYXZlSW5jb21lKG5ld0luY29tZSlcclxuXHRcdFx0LnRoZW4oZnVuY3Rpb24obmV3SW5jb21lKSB7XHJcblx0XHRcdFx0aW5jb21lcy5wdXNoKHNlbGYubm9ybWFsaXplSW5jb21lcyhuZXdJbmNvbWUpWzBdKTtcclxuXHRcdFx0fSwgZnVuY3Rpb24oZXJyKSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coZXJyKVxyXG5cdFx0XHR9KTtcclxuXHR9O1xyXG5cclxuXHQvL2luY29tZS10eXBlc1xyXG5cdHZhciBnZXRBbGxJbmNvbWVUeXBlcyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYoaW5jb21lVHlwZXMgIT0gMCl7XHJcblx0XHRcdHJldHVybiAkcS53aGVuKHR5cGVzKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBkZXBsb3lkU2VydmljZS5nZXRBbGxJbmNvbWVUeXBlcygpXHJcblx0XHRcdC50aGVuKGZ1bmN0aW9uKGFsbEluY29tZVR5cGVzKSB7XHJcblx0XHRcdFx0aW5jb21lVHlwZXMgPSBhbGxJbmNvbWVUeXBlcztcclxuXHRcdFx0XHRyZXR1cm4gaW5jb21lVHlwZXM7XHJcblx0XHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdHZhciBnZXRJbmNvbWVUeXBlID0gZnVuY3Rpb24oaWQpIHtcclxuXHRcdHJldHVybiBkZXBsb3lkU2VydmljZS5nZXRUeXBlKGlkKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbihpbmNvbWVUeXBlKSB7XHJcblx0XHRcdFx0cmV0dXJuIGluY29tZVR5cGU7XHJcblx0XHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdHRoaXMuZ2V0QWxsSW5jb21lcyA9IGdldEFsbEluY29tZXM7XHJcblx0dGhpcy5zYXZlSW5jb21lID0gc2F2ZUluY29tZTtcclxuXHJcblx0dGhpcy5nZXRBbGxJbmNvbWVUeXBlcyA9IGdldEFsbEluY29tZVR5cGVzO1xyXG5cdHRoaXMuZ2V0SW5jb21lVHlwZSA9IGdldEluY29tZVR5cGU7XHJcbn1cclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdidWRnZXR0aW5nSXNGdW4nKVxyXG5cdC5zZXJ2aWNlKCdpbmNvbWVTZXJ2aWNlJywgWyckcScsICdkZXBsb3lkU2VydmljZScsIGluY29tZVNlcnZpY2VdKTsiLCJmdW5jdGlvbiBkZXBsb3lkU2VydmljZSgkaHR0cCwgJHEsIGRlcGxveWQpIHtcclxuXHQvL2J1ZGdldHNcclxuXHR2YXIgYnVkZ2V0cyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHJcblx0XHQkaHR0cC5nZXQoZGVwbG95ZCArICcvYnVkZ2V0cycpXHJcblx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGJ1ZGdldHMpIHtcclxuXHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlKGJ1ZGdldHMpO1xyXG5cdFx0XHR9KS5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuXHRcdFx0XHRkZWZlcnJlZC5yZWplY3QoZXJyKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcblx0fTtcclxuXHJcblx0dmFyIHNhdmVCdWRnZXQgPSBmdW5jdGlvbihuZXdCdWRnZXQpIHtcclxuXHRcdHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcblxyXG5cdFx0JGh0dHAucG9zdChkZXBsb3lkICsgJy9idWRnZXRzJywge1xyXG5cdFx0XHRuYW1lOiBuZXdCdWRnZXQubmFtZSxcclxuXHRcdFx0cGVyY2VudEFsbG90bWVudDogbmV3QnVkZ2V0LnBlcmNlbnRcclxuXHRcdH0pLnN1Y2Nlc3MoZnVuY3Rpb24oYnVkZ2V0KSB7XHJcblx0XHRcdGRlZmVycmVkLnJlc29sdmUoYnVkZ2V0KTtcclxuXHRcdH0pLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG5cdFx0XHRkZWZlcnJlZC5yZWplY3QoZXJyKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG5cdH07XHJcblxyXG5cdHZhciBidWRnZXRJdGVtcyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHJcblx0XHQkaHR0cC5nZXQoZGVwbG95ZCArICcvYnVkZ2V0LWl0ZW1zJylcclxuXHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24oaXRlbXMpIHtcclxuXHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlKGl0ZW1zKTtcclxuXHRcdFx0fSkuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coZXJyKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcblx0fTtcclxuXHJcblx0dmFyIHNhdmVCdWRnZXRJdGVtID0gZnVuY3Rpb24obmV3QnVkZ2V0SXRlbSkge1xyXG5cdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHJcblx0XHQkaHR0cC5wb3N0KGRlcGxveWQgKyAnL2J1ZGdldC1pdGVtcycsIHtcclxuXHRcdFx0bmFtZTogbmV3QnVkZ2V0SXRlbS5uYW1lLFxyXG5cdFx0XHRhbW91bnQ6IG5ld0J1ZGdldEl0ZW0uYW1vdW50LFxyXG5cdFx0XHRidWRnZXRJZDogbmV3QnVkZ2V0SXRlbS5idWRnZXQuaWRcclxuXHRcdH0pLnN1Y2Nlc3MoZnVuY3Rpb24obmV3QnVkZ2V0SXRlbSkge1xyXG5cdFx0XHRkZWZlcnJlZC5yZXNvbHZlKG5ld0J1ZGdldEl0ZW0pO1xyXG5cdFx0fSkuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcblx0XHRcdGRlZmVycmVkLnJlamVjdChlcnIpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcblx0fTtcclxuXHJcblx0Ly9pbmNvbWVzXHJcblx0dmFyIGluY29tZXMgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcblxyXG5cdFx0JGh0dHAuZ2V0KGRlcGxveWQgKyAnL2luY29tZS1zb3VyY2VzJylcclxuXHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24oaW5jb21lcykge1xyXG5cdFx0XHRcdGRlZmVycmVkLnJlc29sdmUoaW5jb21lcyk7XHJcblx0XHRcdH0pLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG5cdFx0XHRcdGRlZmVycmVkLnJlamVjdChlcnIpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRyZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuXHR9O1xyXG5cclxuXHR2YXIgc2F2ZUluY29tZSA9IGZ1bmN0aW9uKG5ld0luY29tZSkge1xyXG5cdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHJcblx0XHQkaHR0cC5wb3N0KGRlcGxveWQgKyAnL2luY29tZS1zb3VyY2VzJywge1xyXG5cdFx0XHRqb2I6IG5ld0luY29tZS5qb2IsXHJcblx0XHRcdGluY29tZVR5cGVJZDogbmV3SW5jb21lLmluY29tZVR5cGUuaWQsXHJcblx0XHRcdHBheXJhdGU6IG5ld0luY29tZS5wYXlyYXRlLFxyXG5cdFx0XHRob3VyczogbmV3SW5jb21lLmhvdXJzLFxyXG5cdFx0XHR0YXhQZXJjZW50OiBuZXdJbmNvbWUudGF4UGVyY2VudFxyXG5cdFx0fSkuc3VjY2VzcyhmdW5jdGlvbihpbmNvbWUpIHtcclxuXHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShpbmNvbWUpO1xyXG5cdFx0fSkuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcblx0XHRcdGRlZmVycmVkLnJlamVjdChlcnIpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcblx0fTtcclxuXHJcblx0Ly9pbmNvbWUtdHlwZXNcclxuXHR2YXIgaW5jb21lVHlwZXMgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcblxyXG5cdFx0JGh0dHAuZ2V0KGRlcGxveWQgKyAnL2luY29tZS10eXBlcycpXHJcblx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGluY29tZVR5cGVzKSB7XHJcblx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShpbmNvbWVUeXBlcyk7XHJcblx0XHRcdH0pLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG5cdFx0XHRcdGRlZmVycmVkLnJlamVjdChlcnIpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRyZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuXHR9XHJcblxyXG5cdHZhciBpbmNvbWVUeXBlID0gZnVuY3Rpb24oaWQpIHtcclxuXHRcdHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcblxyXG5cdFx0JGh0dHAuZ2V0KGRlcGxveWQgKyAnL2luY29tZS10eXBlcz9pZD0nICsgaWQpXHJcblx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGluY29tZVR5cGUpIHtcclxuXHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlKHR5cGUpO1xyXG5cdFx0XHR9KS5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhlcnIpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG5cdH07XHJcblxyXG5cdHRoaXMuZ2V0QWxsQnVkZ2V0cyA9IGJ1ZGdldHM7XHJcblx0dGhpcy5zYXZlQnVkZ2V0ID0gc2F2ZUJ1ZGdldDtcclxuXHR0aGlzLmdldEFsbEJ1ZGdldEl0ZW1zID0gYnVkZ2V0SXRlbXM7XHJcblx0dGhpcy5zYXZlQnVkZ2V0SXRlbSA9IHNhdmVCdWRnZXRJdGVtO1xyXG5cclxuXHR0aGlzLmdldEFsbEluY29tZXMgPSBpbmNvbWVzO1xyXG5cdHRoaXMuc2F2ZUluY29tZSA9IHNhdmVJbmNvbWU7XHJcblxyXG5cdHRoaXMuZ2V0QWxsSW5jb21lVHlwZXMgPSBpbmNvbWVUeXBlcztcclxuXHR0aGlzLmdldEluY29tZVR5cGUgPSBpbmNvbWVUeXBlO1xyXG59XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnYnVkZ2V0dGluZ0lzRnVuJylcclxuXHQuY29uc3RhbnQoJ2RlcGxveWQnLCAnaHR0cDovL2xvY2FsaG9zdDoyNDAzJylcclxuXHQuc2VydmljZSgnZGVwbG95ZFNlcnZpY2UnLCBbJyRodHRwJywgJyRxJywgJ2RlcGxveWQnLCBkZXBsb3lkU2VydmljZV0pOyIsImFuZ3VsYXIubW9kdWxlKCdidWRnZXR0aW5nSXNGdW4nLCBbJ2FuZ3VsYXIuZmlsdGVyJ10pXHJcblx0LmNvbnRyb2xsZXIoJ0Jhc2VDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcclxuXHRcdCRzY29wZS53ZWxjb21lTWVzc2FnZSA9ICdXZWxjb21lIFNhdnkgQnVkZ2V0dGVyJztcclxuXHR9XSk7IiwiYW5ndWxhci5tb2R1bGUoXCJjdXN0b21GaWx0ZXJzXCIsIFtdKVxyXG4gICAgLmZpbHRlcihcInVuaXF1ZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChkYXRhLCBwcm9wZXJ0eU5hbWUpIHtcclxuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSAmJiBhbmd1bGFyLmlzU3RyaW5nKHByb3BlcnR5TmFtZSkpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gW107XHJcbiAgICAgICAgICAgICAgICB2YXIga2V5cyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbCA9IGRhdGFbaV1bcHJvcGVydHlOYW1lXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChrZXlzW3ZhbF0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleXNbdmFsXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChkYXRhW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHRzKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdidWRnZXR0aW5nSXNGdW4nKVxyXG5cdC5jb250cm9sbGVyKCdCdWRnZXRDb250cm9sbGVyJywgWydidWRnZXRTZXJ2aWNlJywgZnVuY3Rpb24oYnVkZ2V0U2VydmljZSkge1xyXG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuXHRcdHNlbGYuYnVkZ2V0cyA9IFtdO1xyXG5cdFx0c2VsZi5idWRnZXRJdGVtcyA9IFtdO1xyXG4gIFxyXG4gIFx0XHRidWRnZXRTZXJ2aWNlLmdldEFsbEJ1ZGdldHMoKVxyXG4gIFx0XHRcdC50aGVuKGZ1bmN0aW9uKGJ1ZGdldHMpIHtcclxuICBcdFx0XHRcdHNlbGYuYnVkZ2V0cyA9IGJ1ZGdldHM7XHJcbiAgXHRcdFx0XHRidWRnZXRTZXJ2aWNlLmdldEFsbEJ1ZGdldEl0ZW1zKClcclxuICBcdFx0XHRcdFx0LnRoZW4oZnVuY3Rpb24oaXRlbXMpIHtcclxuICBcdFx0XHRcdFx0XHRzZWxmLmJ1ZGdldEl0ZW1zID0gaXRlbXM7XHJcbiAgXHRcdFx0XHRcdH0sIGZ1bmN0aW9uKGVycikge1xyXG4gIFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKGVycik7XHJcbiAgXHRcdFx0XHRcdH0pO1xyXG4gIFx0XHRcdH0sIGZ1bmN0aW9uKGVycikge1xyXG4gIFx0XHRcdFx0Y29uc29sZS5sb2coZXJyKTtcclxuICBcdFx0XHR9KTtcclxuXHJcblx0XHRzZWxmLm5ld0J1ZGdldCA9IHt9O1xyXG5cclxuXHRcdHNlbGYuc2F2ZUJ1ZGdldCA9IGZ1bmN0aW9uKG5ld0J1ZGdldCkge1xyXG5cdFx0XHRidWRnZXRTZXJ2aWNlLnNhdmVCdWRnZXQobmV3QnVkZ2V0KTtcclxuXHRcdFx0c2VsZi5uZXdCdWRnZXQgPSB7fTtcclxuXHRcdH07XHJcblxyXG5cdFx0c2VsZi5uZXdCdWRnZXRJdGVtID0ge307XHJcblxyXG5cdFx0c2VsZi5zYXZlQnVkZ2V0SXRlbSA9IGZ1bmN0aW9uKG5ld0J1ZGdldEl0ZW0pIHtcclxuXHRcdFx0YnVkZ2V0U2VydmljZS5zYXZlQnVkZ2V0SXRlbShuZXdCdWRnZXRJdGVtKTtcclxuXHRcdFx0c2VsZi5uZXdCdWRnZXRJdGVtID0ge307XHJcblx0XHR9O1xyXG5cclxuXHRcdHNlbGYudG90YWwgPSBidWRnZXRTZXJ2aWNlLnRvdGFsO1xyXG5cdH1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnYnVkZ2V0dGluZ0lzRnVuJylcclxuXHQuY29udHJvbGxlcignSW5jb21lQ29udHJvbGxlcicsIFsnaW5jb21lU2VydmljZScsIFxyXG5cdFx0ZnVuY3Rpb24oaW5jb21lU2VydmljZSkge1xyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG5cdFx0XHRzZWxmLmluY29tZXMgPSBbXTtcclxuXHRcdFx0c2VsZi5pbmNvbWVUeXBlcyA9IFtdO1xyXG5cclxuXHRcdFx0Ly9pbml0aWFsbHkgZ2V0IGluY29tZXNcclxuXHRcdFx0aW5jb21lU2VydmljZS5nZXRBbGxJbmNvbWVzKClcclxuXHRcdFx0XHQudGhlbihmdW5jdGlvbihpbmNvbWVzKSB7XHJcblx0XHRcdFx0XHRzZWxmLmluY29tZXMgPSBpbmNvbWVzO1xyXG5cdFx0XHRcdH0sIGZ1bmN0aW9uKGVycikge1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coZXJyKTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblxyXG5cdFx0XHQvL2luaXRpYWxseSBnZXQgaW5jb21lVHlwZXNcclxuXHRcdFx0aW5jb21lU2VydmljZS5nZXRBbGxJbmNvbWVUeXBlcygpXHJcblx0XHRcdFx0LnRoZW4oZnVuY3Rpb24oaW5jb21lVHlwZXMpIHtcclxuXHRcdFx0XHRcdHNlbGYuaW5jb21lVHlwZXMgPSBpbmNvbWVUeXBlcztcclxuXHRcdFx0XHR9LCBmdW5jdGlvbihlcnIpIHtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKGVycik7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRzZWxmLm5ld0luY29tZSA9IHt9O1xyXG5cclxuXHRcdFx0c2VsZi5zYXZlSW5jb21lID0gZnVuY3Rpb24obmV3SW5jb21lKSB7XHJcblx0XHRcdFx0aW5jb21lU2VydmljZS5zYXZlSW5jb21lKG5ld0luY29tZSk7XHJcblx0XHRcdFx0c2VsZi5uZXdJbmNvbWUgPSB7fTtcclxuXHRcdFx0fTtcclxuXHR9XSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
